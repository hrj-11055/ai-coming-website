# AIèµ„è®¯ç®¡ç†ç³»ç»Ÿ - é¡¹ç›®æ¶æ„è¯´æ˜æ–‡æ¡£

## ç›®å½•

- [1. é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
- [2. æŠ€æœ¯æ ˆ](#2-æŠ€æœ¯æ ˆ)
- [3. é¡¹ç›®æ–‡ä»¶ç»“æ„](#3-é¡¹ç›®æ–‡ä»¶ç»“æ„)
- [4. æ ¸å¿ƒæ–‡ä»¶è¯´æ˜](#4-æ ¸å¿ƒæ–‡ä»¶è¯´æ˜)
- [5. æ–‡ä»¶è°ƒç”¨å…³ç³»](#5-æ–‡ä»¶è°ƒç”¨å…³ç³»)
- [6. ç³»ç»Ÿæ¶æ„](#6-ç³»ç»Ÿæ¶æ„)
- [7. APIæ¥å£è¯´æ˜](#7-apiæ¥å£è¯´æ˜)
- [8. æ•°æ®æµå‘](#8-æ•°æ®æµå‘)
- [9. å¯åŠ¨æµç¨‹](#9-å¯åŠ¨æµç¨‹)
- [10. æ‰©å±•æŒ‡å—](#10-æ‰©å±•æŒ‡å—)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®ç®€ä»‹

**AIèµ„è®¯ç®¡ç†ç³»ç»Ÿ** æ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œä¸“é—¨ç”¨äºç®¡ç†å’Œå±•ç¤ºAIç›¸å…³çš„æ–°é—»èµ„è®¯ã€å·¥å…·åº“å’Œå…³é”®è¯äº‘ã€‚ç³»ç»Ÿæ”¯æŒå‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæä¾›å®Œæ•´çš„ç®¡ç†åå°å’Œç”¨æˆ·è®¿é—®è¿½è¸ªåŠŸèƒ½ã€‚

### 1.2 æ ¸å¿ƒåŠŸèƒ½

- **èµ„è®¯ç®¡ç†**: æ¯æ—¥å¿«è®¯ã€æ¯å‘¨èµ„è®¯çš„å‘å¸ƒå’Œç®¡ç†
- **å…³é”®è¯äº‘**: åŠ¨æ€å…³é”®è¯å±•ç¤ºå’Œæƒé‡ç®¡ç†
- **AIå·¥å…·åº“**: AIå·¥å…·çš„å±•ç¤ºã€åˆ†ç±»å’Œæœç´¢
- **ç”¨æˆ·è¿½è¸ª**: åŸºäºIPçš„åœ°ç†ä½ç½®ç»Ÿè®¡å’Œè®¿é—®åˆ†æ
- **ç®¡ç†åå°**: å®Œæ•´çš„åå°ç®¡ç†ç³»ç»Ÿå’Œæ•°æ®åˆ†æ

### 1.3 é¡¹ç›®ç‰ˆæœ¬

- **å½“å‰ç‰ˆæœ¬**: 2.0.0
- **å¼€å‘æ¨¡å¼**: JSONæ–‡ä»¶å­˜å‚¨ / MySQLæ•°æ®åº“å­˜å‚¨ï¼ˆåŒæ¨¡å¼æ”¯æŒï¼‰

---

## 2. æŠ€æœ¯æ ˆ

### 2.1 å‰ç«¯æŠ€æœ¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| HTML5 | - | é¡µé¢ç»“æ„ |
| CSS3 | - | æ ·å¼è®¾è®¡ |
| JavaScript (ES6+) | - | å‰ç«¯äº¤äº’é€»è¾‘ |
| Chart.js | 4.4.0 | æ•°æ®å¯è§†åŒ–å›¾è¡¨ |
| Font Awesome | 6.4.0 | å›¾æ ‡åº“ |
| Tailwind CSS | CDN | å“åº”å¼å¸ƒå±€ |

### 2.2 åç«¯æŠ€æœ¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Node.js | - | è¿è¡Œæ—¶ç¯å¢ƒ |
| Express | 4.18.2 | Webæ¡†æ¶ |
| JWT | 9.0.2 | ç”¨æˆ·è®¤è¯ |
| bcryptjs | 2.4.3 | å¯†ç åŠ å¯† |
| cors | 2.8.5 | è·¨åŸŸå¤„ç† |
| dotenv | 16.6.1 | ç¯å¢ƒå˜é‡ |
| MySQL2 | 3.16.2 | æ•°æ®åº“é©±åŠ¨ï¼ˆMySQLæ¨¡å¼ï¼‰ |
| nodemon | 3.0.1 | å¼€å‘çƒ­é‡è½½ |

### 2.3 æ•°æ®å­˜å‚¨

- **JSONæ¨¡å¼**: ä½¿ç”¨æœ¬åœ°JSONæ–‡ä»¶å­˜å‚¨ï¼ˆé»˜è®¤ï¼‰
- **MySQLæ¨¡å¼**: ä½¿ç”¨MySQLæ•°æ®åº“å­˜å‚¨ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

---

## 3. é¡¹ç›®æ–‡ä»¶ç»“æ„

```
ai-coming-website/website/
â”œâ”€â”€ ğŸ“„ å‰ç«¯é¡µé¢ (HTML)
â”‚   â”œâ”€â”€ index.html                    # ä¸»é¡µé¢ (37KB) - èµ„è®¯é¦–é¡µ
â”‚   â”œâ”€â”€ news.html                     # æ–°é—»è¯¦æƒ…é¡µ (16KB)
â”‚   â”œâ”€â”€ admin-login.html              # ç®¡ç†å‘˜ç™»å½•é¡µ (11KB)
â”‚   â”œâ”€â”€ admin-analytics.html          # åœ°ç†ä½ç½®ç»Ÿè®¡é¡µ (20KB)
â”‚   â””â”€â”€ footer.html                   # é¡µè„šç»„ä»¶ (378B)
â”‚
â”œâ”€â”€ ğŸ¨ æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ styles.css                    # å…¨å±€æ ·å¼è¡¨ (12KB)
â”‚
â”œâ”€â”€ ğŸ’» JavaScriptæ–‡ä»¶
â”‚   â”œâ”€â”€ main.js                       # å‰ç«¯ä¸»é€»è¾‘ (54KB)
â”‚   â”œâ”€â”€ api.js                        # APIå®¢æˆ·ç«¯ (8.2KB)
â”‚   â”œâ”€â”€ server-json.js                # åç«¯æœåŠ¡å™¨-JSONæ¨¡å¼ (60KB) â­æ ¸å¿ƒ
â”‚   â”œâ”€â”€ server-mysql.js               # åç«¯æœåŠ¡å™¨-MySQLæ¨¡å¼ (18KB)
â”‚   â”œâ”€â”€ server.js                     # åç«¯æœåŠ¡å™¨-æ—§ç‰ˆ (16KB)
â”‚   â””â”€â”€ admin-accounts-secure.js      # ç®¡ç†å‘˜è´¦å·é…ç½® (765B)
â”‚
â”œâ”€â”€ âš™ï¸ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ .env                          # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â”œâ”€â”€ .env.example                  # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”‚   â”œâ”€â”€ run.sh                        # ä¸€é”®å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ start.sh                      # å¯åŠ¨è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“ æ•°æ®ç›®å½• (data/)
â”‚   â”œâ”€â”€ admins.json                   # ç®¡ç†å‘˜è´¦å·æ•°æ®
â”‚   â”œâ”€â”€ keywords.json                 # å…³é”®è¯æ•°æ®
â”‚   â”œâ”€â”€ news.json                     # æ¯æ—¥å¿«è®¯æ•°æ®
â”‚   â”œâ”€â”€ weekly-news.json              # æ¯å‘¨èµ„è®¯æ•°æ®
â”‚   â”œâ”€â”€ tools.json                    # AIå·¥å…·æ•°æ®
â”‚   â”œâ”€â”€ tool-categories.json          # å·¥å…·åˆ†ç±»æ•°æ®
â”‚   â”œâ”€â”€ settings.json                 # ç³»ç»Ÿè®¾ç½®
â”‚   â”œâ”€â”€ visit-logs.json               # è®¿é—®æ—¥å¿—æ•°æ® â­æ–°å¢
â”‚   â””â”€â”€ archive/                      # å†å²å½’æ¡£
â”‚       â”œâ”€â”€ daily/                    # æ¯æ—¥å½’æ¡£
â”‚       â””â”€â”€ weekly/                   # æ¯å‘¨å½’æ¡£
â”‚
â”œâ”€â”€ ğŸ”§ é…ç½®ç›®å½• (config/)
â”‚   â”œâ”€â”€ database.js                   # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ system-prompt.txt             # ç³»ç»Ÿæç¤ºè¯
â”‚
â”œâ”€â”€ ğŸ“œ è„šæœ¬ç›®å½• (scripts/)
â”‚   â”œâ”€â”€ auto-upload-news.js           # è‡ªåŠ¨ä¸Šä¼ è„šæœ¬
â”‚   â””â”€â”€ migrate-data.js               # æ•°æ®è¿ç§»è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ—„ï¸ æ•°æ®åº“ (database/)
â”‚   â””â”€â”€ schema.sql                    # MySQLæ•°æ®åº“ç»“æ„
â”‚
â”œâ”€â”€ ğŸ–¼ï¸ èµ„æºç›®å½•
â”‚   â”œâ”€â”€ logos/                        # AIå·¥å…·Logoå›¾ç‰‡ (42ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ pic/                          # é¡¹ç›®å›¾ç‰‡
â”‚
â”œâ”€â”€ ğŸ“¦ å¤‡ä»½ç›®å½• (backup/)
â”‚   â”œâ”€â”€ admin-dashboard-backup.html
â”‚   â”œâ”€â”€ admin-login-backup.html
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ ğŸ“š æ–‡æ¡£ç›®å½•
    â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜
    â”œâ”€â”€ RUN_GUIDE.md                  # è¿è¡ŒæŒ‡å— â­æ–°å¢
    â”œâ”€â”€ LOCATION_TRACKING_GUIDE.md    # åœ°ç†ä½ç½®è¿½è¸ªæŒ‡å— â­æ–°å¢
    â”œâ”€â”€ PROJECT_ARCHITECTURE.md       # é¡¹ç›®æ¶æ„è¯´æ˜ â­æœ¬æ–‡æ¡£
    â”œâ”€â”€ API-SETUP-GUIDE.md            # APIé…ç½®æŒ‡å—
    â”œâ”€â”€ MYSQL-SETUP-GUIDE.md          # MySQLé…ç½®æŒ‡å—
    â””â”€â”€ ...
```

---

## 4. æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### 4.1 å‰ç«¯é¡µé¢æ–‡ä»¶

#### index.html (37KB)
**ä½œç”¨**: ç³»ç»Ÿä¸»é¡µé¢ï¼Œå±•ç¤ºAIèµ„è®¯å’Œå…³é”®è¯äº‘

**æ ¸å¿ƒåŠŸèƒ½**:
- å…³é”®è¯äº‘åŠ¨æ€å±•ç¤º
- ä»Šæ—¥å¿«è®¯åˆ—è¡¨
- æ¯å‘¨èµ„è®¯åˆ—è¡¨
- AIå·¥å…·æœç´¢
- è®¿é—®è¿½è¸ªè‡ªåŠ¨ä¸ŠæŠ¥
- ç®¡ç†åå°å…¥å£

**å¼•ç”¨æ–‡ä»¶**:
```html
<script src="main.js"></script>
<link rel="stylesheet" href="styles.css">
```

**å…³é”®å…ƒç´ **:
- `<div id="keywordWall">` - å…³é”®è¯äº‘å®¹å™¨
- `<div id="todayNews">` - ä»Šæ—¥å¿«è®¯å®¹å™¨
- `<div id="weeklyNews">` - æ¯å‘¨èµ„è®¯å®¹å™¨
- `<div class="footer">` - åŒ…å«ç®¡ç†åå°é“¾æ¥

#### news.html (16KB)
**ä½œç”¨**: æ–°é—»è¯¦æƒ…é¡µé¢

**æ ¸å¿ƒåŠŸèƒ½**:
- å±•ç¤ºå®Œæ•´æ–°é—»å†…å®¹
- æ”¯æŒå¤šåª’ä½“å†…å®¹

#### admin-login.html (11KB)
**ä½œç”¨**: ç®¡ç†å‘˜ç™»å½•é¡µé¢

**æ ¸å¿ƒåŠŸèƒ½**:
- ç”¨æˆ·åå¯†ç ç™»å½•
- JWT Tokenå­˜å‚¨
- è‡ªåŠ¨ç™»å½•æ£€æµ‹
- ç™»å½•çŠ¶æ€ç®¡ç†

**è°ƒç”¨API**:
```javascript
POST /api/auth/login
```

#### admin-analytics.html (20KB)
**ä½œç”¨**: åœ°ç†ä½ç½®ç»Ÿè®¡ç®¡ç†é¡µé¢ â­æ–°å¢

**æ ¸å¿ƒåŠŸèƒ½**:
- çœä»½è®¿é—®ç»Ÿè®¡å±•ç¤º
- Chart.jsæŸ±çŠ¶å›¾å¯è§†åŒ–
- è¯¦ç»†è®¿é—®æ—¥å¿—æŸ¥è¯¢
- æ•°æ®ç­›é€‰å’Œåˆ†é¡µ
- æ—§æ—¥å¿—æ¸…ç†

**è°ƒç”¨API**:
```javascript
GET  /api/visit/province-stats  // çœä»½ç»Ÿè®¡
GET  /api/visit/logs            // è®¿é—®æ—¥å¿—
DELETE /api/visit/logs/cleanup  // æ¸…ç†æ—¥å¿—
```

### 4.2 å‰ç«¯JavaScriptæ–‡ä»¶

#### main.js (54KB) â­æ ¸å¿ƒå‰ç«¯æ–‡ä»¶
**ä½œç”¨**: å‰ç«¯ä¸»é€»è¾‘æ§åˆ¶

**ä¸»è¦æ¨¡å—**:

```javascript
// 1. è®¿é—®è¿½è¸ªæ¨¡å— (lines 1-25)
async function trackVisit() {
    fetch('/api/visit/track', { method: 'POST' })
}

// 2. å…³é”®è¯ç®¡ç†æ¨¡å— (lines 50-200)
function initKeywords()
function generateWordCloud()
function updateKeywordWeight()

// 3. æ–°é—»åŠ è½½æ¨¡å— (lines 250-450)
function loadNewsData()
function renderNewsItem()
function filterArticles()

// 4. æ¯å‘¨èµ„è®¯æ¨¡å— (lines 500-700)
function loadWeeklyNewsData()
function filterByCategory()

// 5. AIå·¥å…·æœç´¢æ¨¡å— (lines 750-950)
function searchTools()
function renderTools()
```

**è°ƒç”¨APIåˆ—è¡¨**:
```javascript
GET  /api/keywords           // è·å–å…³é”®è¯
GET  /api/news               // è·å–å¿«è®¯
GET  /api/weekly-news        // è·å–æ¯å‘¨èµ„è®¯
GET  /api/tools              // è·å–å·¥å…·åˆ—è¡¨
GET  /api/tools/categories   // è·å–å·¥å…·åˆ†ç±»
POST /api/visit/track        // è®°å½•è®¿é—® â­æ–°å¢
```

**å…¨å±€å˜é‡**:
```javascript
let currentFilter = 'all'      // å½“å‰ç­›é€‰æ¡ä»¶
let currentCategory = 'all'    // å½“å‰åˆ†ç±»
let currentTab = 'today'       // å½“å‰æ ‡ç­¾é¡µ
let aiKeywords = []            // å…³é”®è¯æ•°æ®
```

#### api.js (8.2KB)
**ä½œç”¨**: APIå®¢æˆ·ç«¯å°è£…

**æ ¸å¿ƒåŠŸèƒ½**:
- ç»Ÿä¸€çš„APIè¯·æ±‚å°è£…
- é”™è¯¯å¤„ç†
- Tokenç®¡ç†

**ç¤ºä¾‹**:
```javascript
// APIè°ƒç”¨ç¤ºä¾‹
async function fetchNews() {
    const response = await fetch('/api/news');
    const data = await response.json();
    return data;
}
```

### 4.3 åç«¯æœåŠ¡å™¨æ–‡ä»¶

#### server-json.js (60KB) â­æ ¸å¿ƒåç«¯æ–‡ä»¶
**ä½œç”¨**: ä¸»æœåŠ¡å™¨ - JSONæ–‡ä»¶å­˜å‚¨æ¨¡å¼

**æŠ€æœ¯æ ˆ**: Node.js + Express + JSONæ–‡ä»¶å­˜å‚¨

**ä¸»è¦æ¨¡å—ç»“æ„**:

```javascript
// ==================== åˆå§‹åŒ–æ¨¡å— (lines 1-150) ====================
require('dotenv').config()           // ç¯å¢ƒå˜é‡
const app = express()                 // Expressåº”ç”¨
const DATA_DIR = path.join(__dirname, 'data')

// æ•°æ®æ–‡ä»¶è·¯å¾„å®šä¹‰ (lines 20-32)
const VISIT_LOGS_FILE = path.join(DATA_DIR, 'visit-logs.json')
const ADMINS_FILE = path.join(DATA_DIR, 'admins.json')
const NEWS_FILE = path.join(DATA_DIR, 'news.json')
// ... æ›´å¤šæ–‡ä»¶è·¯å¾„

// åˆå§‹åŒ–æ•°æ®æ–‡ä»¶ (lines 54-105)
function initDataFiles()

// ==================== è®¤è¯ä¸­é—´ä»¶ (lines 200-280) ====================
function authenticateToken(req, res, next)
function verifyAdmin(req, res, next)

// ==================== APIè·¯ç”±æ¨¡å— ====================

// 1. è®¤è¯API (lines 285-308)
POST /api/auth/login                  // ç®¡ç†å‘˜ç™»å½•

// 2. å…³é”®è¯API (lines 310-380)
GET    /api/keywords                  // è·å–å…³é”®è¯
POST   /api/keywords                  // æ·»åŠ å…³é”®è¯
DELETE /api/keywords/:id              // åˆ é™¤å…³é”®è¯

// 3. æ–°é—»ç®¡ç†API (lines 382-553)
GET    /api/news                      // è·å–å¿«è®¯
POST   /api/news/batch                // æ‰¹é‡å¯¼å…¥å¿«è®¯
DELETE /api/news/:id                  // åˆ é™¤å¿«è®¯
GET    /api/weekly-news               // è·å–æ¯å‘¨èµ„è®¯
POST   /api/weekly-news               // åˆ›å»ºæ¯å‘¨èµ„è®¯
PUT    /api/weekly-news/:id           // æ›´æ–°æ¯å‘¨èµ„è®¯
DELETE /api/weekly-news/:id           // åˆ é™¤æ¯å‘¨èµ„è®¯

// 4. åœ°ç†ä½ç½®ç»Ÿè®¡API (lines 555-736) â­æ–°å¢
POST   /api/visit/track               // è®°å½•è®¿é—®
GET    /api/visit/province-stats      // çœä»½ç»Ÿè®¡
GET    /api/visit/logs                // è®¿é—®æ—¥å¿—
DELETE /api/visit/logs/cleanup        // æ¸…ç†æ—¥å¿—

// 5. ç»Ÿè®¡API (lines 738-770)
GET    /api/stats                     // ç³»ç»Ÿç»Ÿè®¡

// 6. è®¾ç½®API (lines 772-810)
GET    /api/settings                  // è·å–è®¾ç½®
POST   /api/settings                  // æ›´æ–°è®¾ç½®

// 7. å·¥å…·ç®¡ç†API (lines 812-950)
GET    /api/tools                     // è·å–å·¥å…·åˆ—è¡¨
GET    /api/tools/:id                 // è·å–å·¥å…·è¯¦æƒ…
POST   /api/tools                     // æ·»åŠ å·¥å…·
PUT    /api/tools/:id                 // æ›´æ–°å·¥å…·
DELETE /api/tools/:id                 // åˆ é™¤å·¥å…·
POST   /api/tools/batch               // æ‰¹é‡å¯¼å…¥å·¥å…·
POST   /api/tools/upload-logo         // ä¸Šä¼ Logo

// 8. å½’æ¡£API (lines 952-1050)
GET    /api/archive/dates             // è·å–å½’æ¡£æ—¥æœŸåˆ—è¡¨
GET    /api/archive/:date             // è·å–æŒ‡å®šæ—¥æœŸæ•°æ®
DELETE /api/archive/:date             // åˆ é™¤å½’æ¡£æ•°æ®
```

**æ ¸å¿ƒå‡½æ•°**:

```javascript
// 1. IPåœ°å€è§£æ (lines 572-600) â­æ–°å¢
async function getProvinceFromIP(ip)

// 2. æ•°æ®è¯»å†™ (lines 124-143)
function readData(filename)
function writeData(filename, data)

// 3. IDç”Ÿæˆ (lines 107-121)
function generateId(type = 'daily')

// 4. å½’æ¡£åŠŸèƒ½ (lines 146-198)
function archiveOldNews()
function archiveWeeklyNews()
```

**ä¸­é—´ä»¶é“¾**:
```javascript
app.use(cors())                        // è·¨åŸŸå¤„ç†
app.use(express.json())                // JSONè§£æ
app.use(express.static(...))           // é™æ€æ–‡ä»¶æœåŠ¡
app.use(authenticateToken)             // è®¤è¯ä¸­é—´ä»¶ï¼ˆç‰¹å®šè·¯ç”±ï¼‰
```

**å¯åŠ¨æµç¨‹**:
```javascript
1. åŠ è½½ç¯å¢ƒå˜é‡
2. åˆ›å»ºExpressåº”ç”¨
3. åˆå§‹åŒ–æ•°æ®æ–‡ä»¶ (initDataFiles)
4. é…ç½®ä¸­é—´ä»¶
5. æ³¨å†ŒAPIè·¯ç”±
6. å¯åŠ¨æœåŠ¡å™¨ (app.listen)
```

#### server-mysql.js (18KB)
**ä½œç”¨**: MySQLæ•°æ®åº“æ¨¡å¼æœåŠ¡å™¨

**å·®å¼‚ç‚¹**:
- ä½¿ç”¨MySQLä»£æ›¿JSONæ–‡ä»¶
- æ•°æ®åº“è¿æ¥æ± ç®¡ç†
- SQLæŸ¥è¯¢ä»£æ›¿æ–‡ä»¶è¯»å†™

**æ•°æ®åº“é…ç½®**:
```javascript
{
    host: process.env.DB_HOST,
    user: process.env.DB_USER,
    password: process.env.DB_PASSWORD,
    database: process.env.DB_NAME
}
```

#### server.js (16KB)
**ä½œç”¨**: æ—§ç‰ˆæœåŠ¡å™¨ï¼ˆå·²åºŸå¼ƒï¼‰

### 4.4 æ•°æ®æ–‡ä»¶

#### data/admins.json
ç®¡ç†å‘˜è´¦å·æ•°æ®

```json
[
    {
        "id": 1,
        "username": "admin",
        "password_hash": "$2a$10$...",
        "role": "super_admin",
        "created_at": "2026-02-05T01:58:16.859Z"
    }
]
```

#### data/visit-logs.json â­æ–°å¢
è®¿é—®æ—¥å¿—æ•°æ®

```json
[
    {
        "id": 1707123456789,
        "ip": "123.45.67.89",
        "province": "å¹¿ä¸œçœ",
        "country": "ä¸­å›½",
        "date": "2025-02-05T10:30:00.000Z",
        "userAgent": "Mozilla/5.0..."
    }
]
```

#### data/keywords.json
å…³é”®è¯äº‘æ•°æ®

```json
[
    {
        "id": 1707123456789,
        "text": "äººå·¥æ™ºèƒ½",
        "weight": 5,
        "size": "large",
        "created_at": "2025-02-05T10:30:00.000Z"
    }
]
```

#### data/news.json
æ¯æ—¥å¿«è®¯æ•°æ®

#### data/weekly-news.json
æ¯å‘¨èµ„è®¯æ•°æ®

#### data/tools.json
AIå·¥å…·æ•°æ®

### 4.5 é…ç½®æ–‡ä»¶

#### .env
ç¯å¢ƒå˜é‡é…ç½®

```bash
# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# JWTé…ç½®
JWT_SECRET=ai-coming-secret-key

# ç®¡ç†å‘˜è´¦å·
DEFAULT_ADMIN_USERNAME=admin
DEFAULT_ADMIN_PASSWORD=admin123456

# æ•°æ®åº“é…ç½®ï¼ˆMySQLæ¨¡å¼ï¼‰
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=ai_news_system

# APIé…ç½®
SILICONFLOW_API_KEY=sk-...
QWEN_API_KEY=sk-...
```

#### package.json
é¡¹ç›®ä¾èµ–é…ç½®

```json
{
  "name": "ai-news-backend",
  "version": "2.0.0",
  "main": "server-json.js",
  "scripts": {
    "start": "node server-mysql.js",
    "start:dev": "nodemon server-mysql.js",
    "start:legacy": "node server-json.js",      // JSONæ¨¡å¼
    "dev": "nodemon server-mysql.js"
  },
  "dependencies": {
    "bcryptjs": "^2.4.3",
    "cors": "^2.8.5",
    "dotenv": "^16.6.1",
    "express": "^4.18.2",
    "jsonwebtoken": "^9.0.2",
    "mysql2": "^3.16.2"
  }
}
```

---

## 5. æ–‡ä»¶è°ƒç”¨å…³ç³»

### 5.1 å‰ç«¯æ–‡ä»¶è°ƒç”¨é“¾

```
ç”¨æˆ·è®¿é—®
    â†“
index.html
    â”œâ”€â”€ <link href="styles.css">          # åŠ è½½æ ·å¼
    â”œâ”€â”€ <script src="main.js">            # åŠ è½½ä¸»é€»è¾‘
    â””â”€â”€ <div id="keywordWall">            # å…³é”®è¯äº‘å®¹å™¨
            â†“
        main.js æ‰§è¡Œ
            â”œâ”€â”€ trackVisit()              # è‡ªåŠ¨ä¸ŠæŠ¥è®¿é—®
            â”‚   â””â”€â”€ POST /api/visit/track
            â”œâ”€â”€ initKeywords()            # åˆå§‹åŒ–å…³é”®è¯
            â”‚   â””â”€â”€ GET /api/keywords
            â”œâ”€â”€ loadNewsData()            # åŠ è½½å¿«è®¯
            â”‚   â””â”€â”€ GET /api/news
            â””â”€â”€ loadWeeklyNewsData()      # åŠ è½½æ¯å‘¨èµ„è®¯
                â””â”€â”€ GET /api/weekly-news
```

### 5.2 ç®¡ç†åå°è°ƒç”¨é“¾

```
ç”¨æˆ·ç‚¹å‡»"ç®¡ç†åå°"
    â†“
admin-analytics.html
    â”œâ”€â”€ æ£€æŸ¥ç™»å½•çŠ¶æ€
    â”‚   â”œâ”€â”€ æœªç™»å½• â†’ è·³è½¬ admin-login.html
    â”‚   â””â”€â”€ å·²ç™»å½• â†’ åŠ è½½æ•°æ®
    â””â”€â”€ åŠ è½½æ•°æ®
        â”œâ”€â”€ loadProvinceStats()
        â”‚   â””â”€â”€ GET /api/visit/province-stats
        â””â”€â”€ loadLogs()
            â””â”€â”€ GET /api/visit/logs

admin-login.html
    â”œâ”€â”€ ç”¨æˆ·æäº¤ç™»å½•è¡¨å•
    â”œâ”€â”€ POST /api/auth/login
    â”œâ”€â”€ ä¿å­˜Tokenåˆ°localStorage
    â””â”€â”€ è·³è½¬å› admin-analytics.html
```

### 5.3 åç«¯å¤„ç†æµç¨‹

```
HTTPè¯·æ±‚åˆ°è¾¾
    â†“
server-json.js
    â†“
ä¸­é—´ä»¶å¤„ç†
    â”œâ”€â”€ cors()                    # è·¨åŸŸæ£€æŸ¥
    â”œâ”€â”€ express.json()            # JSONè§£æ
    â””â”€â”€ authenticateToken()       # TokenéªŒè¯ï¼ˆéƒ¨åˆ†è·¯ç”±ï¼‰
    â†“
è·¯ç”±åŒ¹é…
    â”œâ”€â”€ /api/auth/*              # è®¤è¯è·¯ç”±
    â”œâ”€â”€ /api/keywords/*          # å…³é”®è¯è·¯ç”±
    â”œâ”€â”€ /api/news/*              # æ–°é—»è·¯ç”±
    â”œâ”€â”€ /api/visit/*             # è®¿é—®ç»Ÿè®¡ â­æ–°å¢
    â””â”€â”€ ...
    â†“
ä¸šåŠ¡é€»è¾‘å¤„ç†
    â”œâ”€â”€ è¯»å–JSONæ–‡ä»¶ (readData)
    â”œâ”€â”€ å¤„ç†ä¸šåŠ¡é€»è¾‘
    â””â”€â”€ å†™å…¥JSONæ–‡ä»¶ (writeData)
    â†“
è¿”å›å“åº”
    â””â”€â”€ res.json(data)
```

### 5.4 æ•°æ®æµå‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯é¡µé¢   â”‚
â”‚  (HTML/JS)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ HTTPè¯·æ±‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  APIè·¯ç”±å±‚   â”‚
â”‚ (server.js) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸šåŠ¡é€»è¾‘å±‚  â”‚
â”‚  (Controllers)â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•°æ®è®¿é—®å±‚  â”‚
â”‚ (Data Layer) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
    â”Œâ”€â”€â”´â”€â”€â”
    â†“     â†“
â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚JSONâ”‚ â”‚ MySQLâ”‚
â”‚Fileâ”‚ â”‚  DB  â”‚
â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ç³»ç»Ÿæ¶æ„

### 6.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·å±‚ (User Layer)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ æ™®é€šç”¨æˆ·  â”‚  â”‚ ç®¡ç†å‘˜   â”‚  â”‚   è®¿å®¢è¿½è¸ªç³»ç»Ÿ    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å‰ç«¯å±•ç¤ºå±‚ (Frontend)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚index.html â”‚  â”‚news.html  â”‚  â”‚admin-analytics   â”‚    â”‚
â”‚  â”‚ main.js   â”‚  â”‚styles.css â”‚  â”‚admin-login.html  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚                 â”‚
         â”‚              â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                APIç½‘å…³å±‚ (API Gateway)                  â”‚
â”‚              Express.js + CORS + JWT                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /api/auth  â”‚ /api/news â”‚ /api/visit â”‚ ...      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Auth Module â”‚ â”‚ News Module â”‚ â”‚Visit Module  â”‚      â”‚
â”‚  â”‚ Keyword Mgr â”‚ â”‚  Tool Mgr   â”‚ â”‚Stats Module  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ•°æ®æŒä¹…å±‚ (Data Persistence)               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚         â”‚ JSON Files  â”‚         â”‚   MySQL     â”‚         â”‚
â”‚         â”‚ (Dev Mode)  â”‚         â”‚ (Prod Mode) â”‚         â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 åˆ†å±‚æ¶æ„è¯´æ˜

#### å±‚çº§1: ç”¨æˆ·å±‚ (User Layer)
- **æ™®é€šç”¨æˆ·**: æµè§ˆèµ„è®¯ã€æœç´¢å·¥å…·
- **ç®¡ç†å‘˜**: ç™»å½•åå°ã€ç®¡ç†å†…å®¹ã€æŸ¥çœ‹ç»Ÿè®¡
- **è®¿å®¢è¿½è¸ª**: è‡ªåŠ¨è®°å½•è®¿é—®ä¿¡æ¯

#### å±‚çº§2: å‰ç«¯å±•ç¤ºå±‚ (Presentation Layer)
- **é¡µé¢ç»„ä»¶**: HTMLé¡µé¢ç»“æ„
- **æ ·å¼å±‚**: CSSæ ·å¼è®¾è®¡
- **äº¤äº’é€»è¾‘**: JavaScriptä¸šåŠ¡é€»è¾‘

#### å±‚çº§3: APIç½‘å…³å±‚ (API Gateway)
- **è·¯ç”±ç®¡ç†**: Expressè·¯ç”±
- **è·¨åŸŸå¤„ç†**: CORSä¸­é—´ä»¶
- **è®¤è¯æˆæƒ**: JWT TokenéªŒè¯

#### å±‚çº§4: ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic)
- **è®¤è¯æ¨¡å—**: ç™»å½•ã€TokenéªŒè¯
- **å†…å®¹æ¨¡å—**: æ–°é—»ã€å…³é”®è¯ã€å·¥å…·ç®¡ç†
- **ç»Ÿè®¡æ¨¡å—**: è®¿é—®ç»Ÿè®¡ã€æ•°æ®åˆ†æ

#### å±‚çº§5: æ•°æ®æŒä¹…å±‚ (Data Persistence)
- **JSONå­˜å‚¨**: å¼€å‘ç¯å¢ƒ
- **MySQLå­˜å‚¨**: ç”Ÿäº§ç¯å¢ƒ

### 6.3 æ¨¡å—åŒ–è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ ¸å¿ƒæ¨¡å—åˆ’åˆ†                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¢ å†…å®¹ç®¡ç†æ¨¡å—                            â”‚
â”‚  â”œâ”€â”€ å…³é”®è¯ç®¡ç† (keywords)                  â”‚
â”‚  â”œâ”€â”€ æ¯æ—¥å¿«è®¯ (daily news)                  â”‚
â”‚  â”œâ”€â”€ æ¯å‘¨èµ„è®¯ (weekly news)                 â”‚
â”‚  â””â”€â”€ å†…å®¹å½’æ¡£ (archive)                     â”‚
â”‚                                             â”‚
â”‚  ğŸ› ï¸ å·¥å…·ç®¡ç†æ¨¡å—                           â”‚
â”‚  â”œâ”€â”€ å·¥å…·åˆ—è¡¨ (tools list)                  â”‚
â”‚  â”œâ”€â”€ å·¥å…·åˆ†ç±» (categories)                  â”‚
â”‚  â”œâ”€â”€ Logoä¸Šä¼  (logo upload)                 â”‚
â”‚  â””â”€â”€ å·¥å…·æœç´¢ (search)                      â”‚
â”‚                                             â”‚
â”‚  ğŸ” è®¤è¯æˆæƒæ¨¡å—                            â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·ç™»å½• (login)                       â”‚
â”‚  â”œâ”€â”€ Tokenç®¡ç† (JWT)                        â”‚
â”‚  â”œâ”€â”€ æƒé™éªŒè¯ (auth)                        â”‚
â”‚  â””â”€â”€ å¯†ç åŠ å¯† (bcrypt)                      â”‚
â”‚                                             â”‚
â”‚  ğŸ“Š ç»Ÿè®¡åˆ†ææ¨¡å— â­æ–°å¢                     â”‚
â”‚  â”œâ”€â”€ è®¿é—®è¿½è¸ª (visit tracking)              â”‚
â”‚  â”œâ”€â”€ åœ°ç†ä½ç½® (IP location)                 â”‚
â”‚  â”œâ”€â”€ çœä»½ç»Ÿè®¡ (province stats)              â”‚
â”‚  â””â”€â”€ æ•°æ®å¯è§†åŒ– (visualization)             â”‚
â”‚                                             â”‚
â”‚  âš™ï¸ ç³»ç»Ÿé…ç½®æ¨¡å—                            â”‚
â”‚  â”œâ”€â”€ ç³»ç»Ÿè®¾ç½® (settings)                    â”‚
â”‚  â”œâ”€â”€ ç¯å¢ƒå˜é‡ (env config)                  â”‚
â”‚  â””â”€â”€ æ•°æ®è¿ç§» (migration)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. APIæ¥å£è¯´æ˜

### 7.1 è®¤è¯ç›¸å…³ API

```
POST /api/auth/login
åŠŸèƒ½: ç®¡ç†å‘˜ç™»å½•
è¯·æ±‚ä½“: { username, password }
å“åº”: { success, token, user }
è®¤è¯: ä¸éœ€è¦
```

### 7.2 å…³é”®è¯ç®¡ç† API

```
GET /api/keywords
åŠŸèƒ½: è·å–å…³é”®è¯åˆ—è¡¨
å“åº”: [{ id, text, weight, size, ... }]

POST /api/keywords
åŠŸèƒ½: æ·»åŠ å…³é”®è¯
è¯·æ±‚ä½“: { text, weight, size }
è®¤è¯: éœ€è¦

DELETE /api/keywords/:id
åŠŸèƒ½: åˆ é™¤å…³é”®è¯
è®¤è¯: éœ€è¦
```

### 7.3 æ–°é—»ç®¡ç† API

```
GET /api/news
åŠŸèƒ½: è·å–æ¯æ—¥å¿«è®¯
æŸ¥è¯¢å‚æ•°: ?limit=20
å“åº”: [{ id, title, content, importance_score, ... }]

POST /api/news/batch
åŠŸèƒ½: æ‰¹é‡å¯¼å…¥å¿«è®¯
è¯·æ±‚ä½“: [{ title, content, source, ... }]
è®¤è¯: éœ€è¦

GET /api/weekly-news
åŠŸèƒ½: è·å–æ¯å‘¨èµ„è®¯
æŸ¥è¯¢å‚æ•°: ?category=æŠ€æœ¯&limit=10
å“åº”: [{ id, title, category, content, ... }]

POST /api/weekly-news
åŠŸèƒ½: åˆ›å»ºæ¯å‘¨èµ„è®¯
è¯·æ±‚ä½“: { title, category, content, ... }
è®¤è¯: éœ€è¦
```

### 7.4 åœ°ç†ä½ç½®ç»Ÿè®¡ API â­æ–°å¢

```
POST /api/visit/track
åŠŸèƒ½: è®°å½•ç”¨æˆ·è®¿é—®
å“åº”: { success, province }
è®¤è¯: ä¸éœ€è¦
è¯´æ˜: è‡ªåŠ¨è·å–IPå¹¶è¯†åˆ«çœä»½

GET /api/visit/province-stats
åŠŸèƒ½: è·å–çœä»½ç»Ÿè®¡æ•°æ®
å“åº”: { total, provinceStats: [{ province, count }] }
è®¤è¯: éœ€è¦

GET /api/visit/logs
åŠŸèƒ½: è·å–è®¿é—®æ—¥å¿—
æŸ¥è¯¢å‚æ•°: ?page=1&limit=20&province=å¹¿ä¸œçœ
å“åº”: { logs: [...], pagination: {...} }
è®¤è¯: éœ€è¦

DELETE /api/visit/logs/cleanup
åŠŸèƒ½: æ¸…ç†æ—§æ—¥å¿—
æŸ¥è¯¢å‚æ•°: ?days=30
å“åº”: { success, deleted, remaining }
è®¤è¯: éœ€è¦
```

### 7.5 å·¥å…·ç®¡ç† API

```
GET /api/tools
åŠŸèƒ½: è·å–AIå·¥å…·åˆ—è¡¨
æŸ¥è¯¢å‚æ•°: ?category=è®¾è®¡&search=AI&page=1
å“åº”: { tools: [...], total, pagination }

GET /api/tools/categories
åŠŸèƒ½: è·å–å·¥å…·åˆ†ç±»
å“åº”: [{ id, name, count }]

POST /api/tools
åŠŸèƒ½: æ·»åŠ å·¥å…·
è¯·æ±‚ä½“: { name, category, description, website, ... }
è®¤è¯: éœ€è¦

POST /api/tools/upload-logo
åŠŸèƒ½: ä¸Šä¼ å·¥å…·Logo
è¯·æ±‚ç±»å‹: multipart/form-data
è®¤è¯: éœ€è¦
```

### 7.6 ç³»ç»Ÿè®¾ç½® API

```
GET /api/settings
åŠŸèƒ½: è·å–ç³»ç»Ÿè®¾ç½®
å“åº”: { todayNewsDisplayCount, autoArchiveEnabled, ... }

POST /api/settings
åŠŸèƒ½: æ›´æ–°ç³»ç»Ÿè®¾ç½®
è¯·æ±‚ä½“: { todayNewsDisplayCount: 20, ... }
è®¤è¯: éœ€è¦
```

### 7.7 å½’æ¡£ç®¡ç† API

```
GET /api/archive/dates
åŠŸèƒ½: è·å–å†å²å½’æ¡£æ—¥æœŸåˆ—è¡¨
å“åº”: { dates: ["2025-01-15", "2025-01-16"] }

GET /api/archive/:date
åŠŸèƒ½: è·å–æŒ‡å®šæ—¥æœŸçš„å†å²æ•°æ®
å“åº”: { daily: [...], weekly: [...] }

DELETE /api/archive/:date
åŠŸèƒ½: åˆ é™¤æŒ‡å®šæ—¥æœŸçš„å½’æ¡£
è®¤è¯: éœ€è¦
```

---

## 8. æ•°æ®æµå‘

### 8.1 ç”¨æˆ·è®¿é—®æµç¨‹

```
1. ç”¨æˆ·è®¿é—® index.html
   â†“
2. main.js è‡ªåŠ¨æ‰§è¡Œ trackVisit()
   â†“
3. POST /api/visit/track
   â”œâ”€ è·å–ç”¨æˆ·IP
   â”œâ”€ è°ƒç”¨ getProvinceFromIP(ip)
   â”‚   â””â”€ æ·˜å®IPæ¥å£ â†’ çœä»½åç§°
   â”œâ”€ æ£€æŸ¥ä»Šæ—¥æ˜¯å¦å·²è®°å½•ï¼ˆå»é‡ï¼‰
   â””â”€ å†™å…¥ visit-logs.json
   â†“
4. åŠ è½½é¡µé¢å†…å®¹
   â”œâ”€ GET /api/keywords â†’ æ¸²æŸ“å…³é”®è¯äº‘
   â”œâ”€ GET /api/news â†’ æ¸²æŸ“ä»Šæ—¥å¿«è®¯
   â””â”€ GET /api/weekly-news â†’ æ¸²æŸ“æ¯å‘¨èµ„è®¯
```

### 8.2 ç®¡ç†å‘˜ç™»å½•æµç¨‹

```
1. è®¿é—® admin-analytics.html
   â†“
2. æ£€æŸ¥ localStorage.getItem('admin_token')
   â”œâ”€ å­˜åœ¨ â†’ åŠ è½½æ•°æ®
   â””â”€ ä¸å­˜åœ¨ â†’ è·³è½¬ admin-login.html
   â†“
3. è¾“å…¥ç”¨æˆ·åå¯†ç 
   â†“
4. POST /api/auth/login
   â”œâ”€ è¯»å– admins.json
   â”œâ”€ bcrypt.compareSync(password, hash)
   â”œâ”€ ç”Ÿæˆ JWT Token (24hæœ‰æ•ˆ)
   â””â”€ è¿”å› { token, user }
   â†“
5. ä¿å­˜ Token
   localStorage.setItem('admin_token', token)
   â†“
6. è·³è½¬å› admin-analytics.html
   â†“
7. ä½¿ç”¨ Token è®¿é—®å—ä¿æŠ¤API
   GET /api/visit/province-stats
   Headers: Authorization: Bearer {token}
```

### 8.3 å†…å®¹ç®¡ç†æµç¨‹

```
æ·»åŠ æ–°é—»æµç¨‹:
1. ç®¡ç†å‘˜ç™»å½•åå°
2. POST /api/news/batch
   Headers: Authorization: Bearer {token}
   Body: [{ title, content, source, ... }]
   â†“
3. server-json.js å¤„ç†
   â”œâ”€ authenticateToken() éªŒè¯Token
   â”œâ”€ è¯»å– news.json
   â”œâ”€ ç”Ÿæˆå”¯ä¸€ID
   â”œâ”€ æ·»åŠ æ—¶é—´æˆ³
   â””â”€ å†™å…¥ news.json
   â†“
4. è¿”å›æˆåŠŸå“åº”
   â†“
5. å‰ç«¯åˆ·æ–°åˆ—è¡¨
   GET /api/news
```

---

## 9. å¯åŠ¨æµç¨‹

### 9.1 æœåŠ¡å™¨å¯åŠ¨æµç¨‹

```
æ‰§è¡Œ: npm start
æˆ–: npm run start:legacy (JSONæ¨¡å¼)
â†“
1. Node.js åŠ è½½ server-json.js
â†“
2. require('dotenv').config()
   â””â”€ è¯»å– .env æ–‡ä»¶
â†“
3. åˆ›å»º Express åº”ç”¨
   const app = express()
â†“
4. é…ç½®ä¸­é—´ä»¶
   app.use(cors())
   app.use(express.json())
   app.use(express.static('.'))
â†“
5. initDataFiles() - åˆå§‹åŒ–æ•°æ®æ–‡ä»¶
   â”œâ”€ æ£€æŸ¥ data/*.json æ˜¯å¦å­˜åœ¨
   â”œâ”€ ä¸å­˜åœ¨åˆ™åˆ›å»ºç©ºæ–‡ä»¶
   â””â”€ åˆå§‹åŒ–é»˜è®¤ç®¡ç†å‘˜è´¦å·
       â””â”€ è¯»å– .env ä¸­çš„ DEFAULT_ADMIN_*
       â””â”€ bcrypt.hashSync(password)
       â””â”€ å†™å…¥ admins.json
â†“
6. æ³¨å†ŒAPIè·¯ç”±
   app.post('/api/auth/login', ...)
   app.get('/api/keywords', ...)
   ... (çº¦30ä¸ªAPIç«¯ç‚¹)
â†“
7. å¯åŠ¨HTTPæœåŠ¡å™¨
   app.listen(PORT)
   â””â”€ é»˜è®¤: http://localhost:3000
â†“
8. æ§åˆ¶å°è¾“å‡º
   â”œâ”€ âœ… ç³»ç»Ÿæç¤ºè¯å·²åŠ è½½
   â”œâ”€ Default admin initialized
   â”œâ”€ æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000
   â””â”€ APIæ–‡æ¡£åˆ—è¡¨
```

### 9.2 å‰ç«¯åŠ è½½æµç¨‹

```
ç”¨æˆ·è®¿é—®: http://localhost:3000
â†“
1. æµè§ˆå™¨è¯·æ±‚ index.html
â†“
2. Expressé™æ€æ–‡ä»¶æœåŠ¡è¿”å› index.html
â†“
3. æµè§ˆå™¨è§£æHTML
   â”œâ”€ <link href="styles.css"> â†’ åŠ è½½æ ·å¼
   â”œâ”€ <script src="main.js"> â†’ åŠ è½½è„šæœ¬
   â””â”€ æ¸²æŸ“DOMç»“æ„
â†“
4. main.js æ‰§è¡Œ
   â”œâ”€ trackVisit() â†’ POST /api/visit/track
   â”œâ”€ initKeywords() â†’ GET /api/keywords
   â”œâ”€ generateWordCloud() â†’ æ¸²æŸ“å…³é”®è¯
   â””â”€ loadNewsData() â†’ GET /api/news
â†“
5. é¡µé¢å®Œå…¨åŠ è½½å®Œæˆ
```

### 9.3 ç¯å¢ƒå˜é‡åŠ è½½é¡ºåº

```
1. ç³»ç»Ÿç¯å¢ƒå˜é‡
   process.env
â†“
2. .env æ–‡ä»¶
   dotenv.config()
â†“
3. ä»£ç é»˜è®¤å€¼
   const PORT = process.env.PORT || 3000
```

---

## 10. æ‰©å±•æŒ‡å—

### 10.1 æ·»åŠ æ–°çš„APIç«¯ç‚¹

**æ­¥éª¤**:

1. åœ¨ `server-json.js` ä¸­æ·»åŠ è·¯ç”±
```javascript
app.get('/api/new-endpoint', (req, res) => {
    // ä¸šåŠ¡é€»è¾‘
    res.json({ data: 'response' });
});
```

2. å¦‚æœéœ€è¦è®¤è¯ï¼Œæ·»åŠ ä¸­é—´ä»¶
```javascript
app.get('/api/new-endpoint', authenticateToken, (req, res) => {
    // ä¸šåŠ¡é€»è¾‘
});
```

3. åœ¨å‰ç«¯ `main.js` ä¸­è°ƒç”¨
```javascript
async function callNewAPI() {
    const response = await fetch('/api/new-endpoint');
    const data = await response.json();
    return data;
}
```

### 10.2 æ·»åŠ æ–°çš„æ•°æ®æ¨¡å‹

**æ­¥éª¤**:

1. åœ¨ `initDataFiles()` ä¸­åˆå§‹åŒ–æ–‡ä»¶
```javascript
const NEW_MODEL_FILE = path.join(DATA_DIR, 'new-model.json');
if (!fs.existsSync(NEW_MODEL_FILE)) {
    fs.writeFileSync(NEW_MODEL_FILE, JSON.stringify([]));
}
```

2. åˆ›å»ºCRUD API
```javascript
// åˆ›å»º
app.post('/api/new-model', (req, res) => {
    const data = readData(NEW_MODEL_FILE);
    const newItem = { id: Date.now(), ...req.body };
    data.push(newItem);
    writeData(NEW_MODEL_FILE, data);
    res.json(newItem);
});

// è¯»å–
app.get('/api/new-model', (req, res) => {
    const data = readData(NEW_MODEL_FILE);
    res.json(data);
});

// æ›´æ–°
app.put('/api/new-model/:id', (req, res) => {
    const data = readData(NEW_MODEL_FILE);
    const index = data.findIndex(item => item.id === req.params.id);
    if (index !== -1) {
        data[index] = { ...data[index], ...req.body };
        writeData(NEW_MODEL_FILE, data);
        res.json(data[index]);
    } else {
        res.status(404).json({ error: 'Not found' });
    }
});

// åˆ é™¤
app.delete('/api/new-model/:id', (req, res) => {
    const data = readData(NEW_MODEL_FILE);
    const filtered = data.filter(item => item.id !== req.params.id);
    writeData(NEW_MODEL_FILE, filtered);
    res.json({ success: true });
});
```

### 10.3 åˆ‡æ¢åˆ°MySQLæ¨¡å¼

**æ­¥éª¤**:

1. å®‰è£…MySQLå¹¶åˆ›å»ºæ•°æ®åº“
```bash
mysql -u root -p < database/schema.sql
```

2. é…ç½® `.env` æ–‡ä»¶
```bash
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=ai_news_system
```

3. å¯åŠ¨MySQLæ¨¡å¼æœåŠ¡å™¨
```bash
npm start  # é»˜è®¤å¯åŠ¨ server-mysql.js
```

### 10.4 éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

**æ­¥éª¤**:

1. ä½¿ç”¨ `deploy-linux.sh` è„šæœ¬
```bash
chmod +x deploy-linux.sh
./deploy-linux.sh
```

2. æˆ–æ‰‹åŠ¨éƒ¨ç½²
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export NODE_ENV=production

# å¯åŠ¨æœåŠ¡
npm run start:prod

# ä½¿ç”¨PM2ç®¡ç†è¿›ç¨‹
pm2 start server-mysql.js --name "ai-news-system"
```

### 10.5 æ·»åŠ æ–°çš„å‰ç«¯é¡µé¢

**æ­¥éª¤**:

1. åˆ›å»ºHTMLæ–‡ä»¶ `new-page.html`
2. å¼•å…¥æ ·å¼å’Œè„šæœ¬
```html
<link rel="stylesheet" href="styles.css">
<script src="main.js"></script>
<script src="custom.js"></script>
```

3. åœ¨ `index.html` ä¸­æ·»åŠ é“¾æ¥
```html
<a href="new-page.html">æ–°é¡µé¢</a>
```

### 10.6 è‡ªå®šä¹‰æ ·å¼

**æ–¹æ³•**:

1. ç›´æ¥ä¿®æ”¹ `styles.css`
2. æˆ–åˆ›å»ºè‡ªå®šä¹‰CSSæ–‡ä»¶
```html
<link rel="stylesheet" href="custom-styles.css">
```

3. ä½¿ç”¨Tailwind CSS CDNï¼ˆå·²é›†æˆï¼‰
```html
<div class="flex items-center justify-center p-4 bg-blue-500">
    <!-- å†…å®¹ -->
</div>
```

---

## é™„å½•

### A. æ–‡ä»¶å¤§å°ç»Ÿè®¡

| æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|------|------|------|
| server-json.js | 60KB | æœ€å¤§çš„åç«¯æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰API |
| main.js | 54KB | æœ€å¤§çš„å‰ç«¯æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰äº¤äº’é€»è¾‘ |
| index.html | 37KB | ä¸»é¡µé¢ |
| admin-analytics.html | 20KB | ç»Ÿè®¡é¡µé¢ â­æ–°å¢ |
| server-mysql.js | 18KB | MySQLæ¨¡å¼æœåŠ¡å™¨ |
| styles.css | 12KB | å…¨å±€æ ·å¼ |
| news.html | 16KB | æ–°é—»é¡µ |
| admin-login.html | 11KB | ç™»å½•é¡µ |
| api.js | 8.2KB | APIå°è£… |

### B. APIç«¯ç‚¹æ•°é‡ç»Ÿè®¡

- **è®¤è¯API**: 1ä¸ª
- **å…³é”®è¯API**: 3ä¸ª
- **æ–°é—»API**: 9ä¸ª
- **å·¥å…·API**: 7ä¸ª
- **ç»Ÿè®¡API**: 2ä¸ª
- **è®¿é—®ç»Ÿè®¡API**: 4ä¸ª â­æ–°å¢
- **è®¾ç½®API**: 2ä¸ª
- **å½’æ¡£API**: 3ä¸ª
- **æ€»è®¡**: çº¦31ä¸ªAPIç«¯ç‚¹

### C. ä¾èµ–åŒ…æ¸…å•

```json
{
  "dependencies": {
    "bcryptjs": "^2.4.3",        // å¯†ç åŠ å¯†
    "cors": "^2.8.5",            // è·¨åŸŸå¤„ç†
    "dotenv": "^16.6.1",         // ç¯å¢ƒå˜é‡
    "express": "^4.18.2",        // Webæ¡†æ¶
    "jsonwebtoken": "^9.0.2",    // JWTè®¤è¯
    "mysql2": "^3.16.2"          // MySQLé©±åŠ¨
  },
  "devDependencies": {
    "nodemon": "^3.0.1"          // çƒ­é‡è½½
  }
}
```

### D. ç«¯å£ä½¿ç”¨æƒ…å†µ

- **å¼€å‘ç¯å¢ƒ**: 3000 (é»˜è®¤)
- **ç”Ÿäº§ç¯å¢ƒ**: é€šè¿‡ç¯å¢ƒå˜é‡ `PORT` é…ç½®

### E. æ•°æ®æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ç”¨é€” | æ ¼å¼ |
|------|------|------|
| admins.json | ç®¡ç†å‘˜è´¦å· | JSONæ•°ç»„ |
| keywords.json | å…³é”®è¯äº‘æ•°æ® | JSONæ•°ç»„ |
| news.json | æ¯æ—¥å¿«è®¯ | JSONæ•°ç»„ |
| weekly-news.json | æ¯å‘¨èµ„è®¯ | JSONæ•°ç»„ |
| tools.json | AIå·¥å…·åº“ | JSONæ•°ç»„ |
| tool-categories.json | å·¥å…·åˆ†ç±» | JSONæ•°ç»„ |
| settings.json | ç³»ç»Ÿè®¾ç½® | JSONå¯¹è±¡ |
| visit-logs.json | è®¿é—®æ—¥å¿— â­æ–°å¢ | JSONæ•°ç»„ |

---

## æ›´æ–°æ—¥å¿—

### v2.0.0 (2025-02-05) - åœ°ç†ä½ç½®ç»Ÿè®¡ç‰ˆæœ¬

**æ–°å¢åŠŸèƒ½**:
- âœ¨ ç”¨æˆ·è®¿é—®è¿½è¸ªç³»ç»Ÿ
- âœ¨ IPåœ°å€è‡ªåŠ¨è¯†åˆ«çœä»½
- âœ¨ åœ°ç†ä½ç½®ç»Ÿè®¡åˆ†æ
- âœ¨ ç®¡ç†å‘˜ç™»å½•ç³»ç»Ÿ
- âœ¨ å¯è§†åŒ–æ•°æ®å›¾è¡¨

**æ–°å¢æ–‡ä»¶**:
- admin-login.html (11KB)
- admin-analytics.html (20KB)
- data/visit-logs.json
- LOCATION_TRACKING_GUIDE.md
- RUN_GUIDE.md
- PROJECT_ARCHITECTURE.md (æœ¬æ–‡æ¡£)

**æ–°å¢API**:
- POST /api/visit/track
- GET /api/visit/province-stats
- GET /api/visit/logs
- DELETE /api/visit/logs/cleanup

---

## è”ç³»æ–¹å¼

- **é¡¹ç›®**: AIèµ„è®¯ç®¡ç†ç³»ç»Ÿ
- **ç‰ˆæœ¬**: 2.0.0
- **æœ€åæ›´æ–°**: 2025-02-05
- **æ–‡æ¡£ç»´æŠ¤**: å¼€å‘å›¢é˜Ÿ

---

**æ–‡æ¡£ç»“æŸ**
