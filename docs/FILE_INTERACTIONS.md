# AIèµ„è®¯ç½‘ç«™ - æ–‡ä»¶äº¤äº’å…³ç³»è¯¦è§£

## æ¶æ„æ¦‚è§ˆå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸŒ å‰ç«¯å±‚ (æµè§ˆå™¨)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  index.html  â”‚  news.html  â”‚  admin.html  â”‚  weekly.html  â”‚  tools.html      â”‚
â”‚              â”‚             â”‚             â”‚              â”‚  keywords.html    â”‚
â”‚              â”‚             â”‚             â”‚              â”‚  visitors.html    â”‚
â”‚              â”‚             â”‚             â”‚              â”‚  archive.html     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“ å¼•ç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      js/main.js (1500è¡Œ) - æ ¸å¿ƒå‰ç«¯é€»è¾‘                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ é¡µé¢åˆå§‹åŒ–  â€¢ APIè°ƒç”¨  â€¢ æ•°æ®æ¸²æŸ“  â€¢ ç”¨æˆ·äº¤äº’  â€¢ JWTç®¡ç†                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“ APIè¯·æ±‚ (HTTP REST)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   âš™ï¸ åç«¯å±‚ - server-json.js (2022è¡Œ)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  41ä¸ªAPIç«¯ç‚¹  â”‚  JWTè®¤è¯  â”‚  æ•°æ®éªŒè¯  â”‚  å½’æ¡£ç³»ç»Ÿ  â”‚  è®¿å®¢è¿½è¸ª               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“ æ–‡ä»¶è¯»å†™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ’¾ æ•°æ®å­˜å‚¨å±‚ (JSONæ–‡ä»¶)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  news.json  â”‚  weekly-news.json  â”‚  tools.json  â”‚  keywords.json             â”‚
â”‚  visitors.json  â”‚  settings.json  â”‚  archive/*.json                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è¯¦ç»†æ–‡ä»¶æ¸…å•ä¸ä¾èµ–å…³ç³»

### 1. å‰ç«¯HTMLé¡µé¢ (8ä¸ª)

#### index.html - ä¸»é¡µ
- **æ–‡ä»¶è·¯å¾„**: `/index.html`
- **åŠŸèƒ½**: ç½‘ç«™é¦–é¡µå…¥å£
- **åŠ è½½è„šæœ¬**: `<script src="js/main.js"></script>`
- **è°ƒç”¨API**:
  - `GET /api/news` - è·å–ä»Šæ—¥èµ„è®¯
  - `GET /api/weekly-news` - è·å–æ¯å‘¨èµ„è®¯
  - `GET /api/keywords` - è·å–å…³é”®è¯äº‘
  - `POST /api/visitors` - è®°å½•è®¿é—®
- **æ¸²æŸ“å†…å®¹**: å¯¼èˆªæ ã€èµ„è®¯å¡ç‰‡ã€å…³é”®è¯äº‘ã€é¡µè„š

#### news.html - æ—¥æŠ¥é¡µé¢
- **æ–‡ä»¶è·¯å¾„**: `/news.html`
- **åŠŸèƒ½**: å±•ç¤ºAIæ—¥æŠ¥å†…å®¹
- **åŠ è½½è„šæœ¬**: `js/main.js`
- **è°ƒç”¨API**:
  - `GET /api/news` - è·å–ä»Šæ—¥èµ„è®¯
  - `GET /api/weekly-news` - è·å–æ¯å‘¨èµ„è®¯
  - `GET /api/archive/:date` - è·å–å†å²å½’æ¡£
- **æ¸²æŸ“å†…å®¹**: æ—¥æŠ¥åˆ—è¡¨ã€åˆ†ç±»ç­›é€‰ã€æœç´¢åŠŸèƒ½ã€æ—¥æœŸå¯¼èˆª

#### admin.html - ç®¡ç†åå°
- **æ–‡ä»¶è·¯å¾„**: `/admin.html`
- **åŠŸèƒ½**: ç®¡ç†å‘˜æ“ä½œç•Œé¢
- **åŠ è½½è„šæœ¬**: `js/main.js`
- **è°ƒç”¨API** (éœ€JWTè®¤è¯):
  - `POST /api/auth/login` - ç®¡ç†å‘˜ç™»å½•
  - `GET /api/news` - è·å–èµ„è®¯åˆ—è¡¨
  - `POST /api/news/batch` - æ‰¹é‡å¯¼å…¥èµ„è®¯
  - `DELETE /api/news/:id` - åˆ é™¤èµ„è®¯
  - `GET /api/weekly-news` - è·å–æ¯å‘¨èµ„è®¯
  - `POST /api/weekly-news` - åˆ›å»ºæ¯å‘¨èµ„è®¯
  - `PUT /api/weekly-news/:id` - æ›´æ–°æ¯å‘¨èµ„è®¯
  - `DELETE /api/weekly-news/:id` - åˆ é™¤æ¯å‘¨èµ„è®¯
  - `GET /api/tools` - è·å–AIå·¥å…·åˆ—è¡¨
  - `POST /api/tools` - æ·»åŠ å·¥å…·
  - `PUT /api/tools/:id` - æ›´æ–°å·¥å…·
  - `DELETE /api/tools/:id` - åˆ é™¤å·¥å…·
  - `GET /api/keywords` - è·å–å…³é”®è¯
  - `POST /api/keywords/batch` - æ‰¹é‡å¯¼å…¥å…³é”®è¯
  - `DELETE /api/keywords/:id` - åˆ é™¤å…³é”®è¯
  - `GET /api/stats` - è·å–ç»Ÿè®¡æ•°æ®
  - `GET /api/visitors` - è·å–è®¿å®¢è®°å½•
  - `GET /api/settings` - è·å–ç³»ç»Ÿè®¾ç½®
  - `POST /api/settings` - æ›´æ–°ç³»ç»Ÿè®¾ç½®
- **æ¸²æŸ“å†…å®¹**: ç™»å½•è¡¨å•ã€æ•°æ®è¡¨æ ¼ã€ç¼–è¾‘è¡¨å•ã€ç»Ÿè®¡å›¾è¡¨

#### weekly.html - æ¯å‘¨èµ„è®¯
- **æ–‡ä»¶è·¯å¾„**: `/weekly.html`
- **åŠŸèƒ½**: æ·±åº¦å‘¨åˆŠå±•ç¤º
- **åŠ è½½è„šæœ¬**: `js/main.js`
- **è°ƒç”¨API**: `GET /api/weekly-news`
- **æ¸²æŸ“å†…å®¹**: å‘¨åˆŠåˆ—è¡¨ã€åˆ†ç±»ç­›é€‰ã€è¯¦æƒ…å±•ç¤º

#### tools.html - AIå·¥å…·é¡µé¢
- **æ–‡ä»¶è·¯å¾„**: `/tools.html`
- **åŠŸèƒ½**: AIå·¥å…·å¯¼èˆª
- **åŠ è½½è„šæœ¬**: `js/main.js`
- **è°ƒç”¨API**: `GET /api/tools`
- **æ¸²æŸ“å†…å®¹**: å·¥å…·å¡ç‰‡ã€åˆ†ç±»ç­›é€‰ã€æœç´¢åŠŸèƒ½

#### keywords.html - å…³é”®è¯é¡µé¢
- **æ–‡ä»¶è·¯å¾„**: `/keywords.html`
- **åŠŸèƒ½**: å…³é”®è¯äº‘å±•ç¤º
- **åŠ è½½è„šæœ¬**: `js/main.js`
- **è°ƒç”¨API**: `GET /api/keywords`
- **æ¸²æŸ“å†…å®¹**: å…³é”®è¯äº‘ã€æƒé‡å¯è§†åŒ–

#### visitors.html - è®¿å®¢ç»Ÿè®¡
- **æ–‡ä»¶è·¯å¾„**: `/visitors.html`
- **åŠŸèƒ½**: è®¿å®¢æ•°æ®å¯è§†åŒ–
- **åŠ è½½è„šæœ¬**: `js/main.js`
- **è°ƒç”¨API**: `GET /api/visitors`, `GET /api/stats`
- **æ¸²æŸ“å†…å®¹**: åœ°åŸŸåˆ†å¸ƒå›¾ã€è®¿é—®è¶‹åŠ¿ã€ç»Ÿè®¡æ•°æ®

#### archive.html - å†å²å½’æ¡£
- **æ–‡ä»¶è·¯å¾„**: `/archive.html`
- **åŠŸèƒ½**: å†å²æ•°æ®æµè§ˆ
- **åŠ è½½è„šæœ¬**: `js/main.js`
- **è°ƒç”¨API**:
  - `GET /api/archive/dates` - è·å–å½’æ¡£æ—¥æœŸåˆ—è¡¨
  - `GET /api/archive/:date` - è·å–æŒ‡å®šæ—¥æœŸæ•°æ®
- **æ¸²æŸ“å†…å®¹**: æ—¥æœŸé€‰æ‹©å™¨ã€å†å²æ•°æ®å±•ç¤º

---

### 2. å‰ç«¯é€»è¾‘å±‚

#### js/main.js (1500è¡Œ)
- **æ–‡ä»¶è·¯å¾„**: `/js/main.js`
- **åŠŸèƒ½**: æ ¸å¿ƒå‰ç«¯é€»è¾‘æ§åˆ¶å™¨
- **ä¸»è¦æ¨¡å—**:
  1. **é¡µé¢åˆå§‹åŒ–æ¨¡å—**
     - æ£€æµ‹å½“å‰é¡µé¢
     - åŠ è½½é¡µé¢é…ç½®
     - åˆå§‹åŒ–UIç»„ä»¶

  2. **APIè°ƒç”¨æ¨¡å—**
     ```javascript
     const API_BASE = 'http://localhost:3000/api';

     // é€šç”¨è¯·æ±‚å‡½æ•°
     async function apiRequest(endpoint, method, data, token) {
         // å¤„ç†HTTPè¯·æ±‚
         // æ·»åŠ JWTè®¤è¯å¤´
         // é”™è¯¯å¤„ç†
     }

     // å…·ä½“APIè°ƒç”¨å‡½æ•°
     async function loadNews() { /* ... */ }
     async function loadWeeklyNews() { /* ... */ }
     async function loadTools() { /* ... */ }
     async function loadKeywords() { /* ... */ }
     async function loadVisitors() { /* ... */ }
     ```

  3. **JWTè®¤è¯æ¨¡å—**
     ```javascript
     let authToken = localStorage.getItem('adminToken');

     function login(username, password) {
         // POST /api/auth/login
         // ä¿å­˜tokenåˆ°localStorage
     }

     function logout() {
         // æ¸…é™¤token
         // è·³è½¬åˆ°ç™»å½•é¡µ
     }
     ```

  4. **æ•°æ®æ¸²æŸ“æ¨¡å—**
     ```javascript
     function renderNewsCards(newsData) {
         // ç”ŸæˆHTMLå¡ç‰‡
         // æ’å…¥åˆ°DOM
         // ç»‘å®šäº¤äº’äº‹ä»¶
     }

     function renderKeywordsCloud(keywords) {
         // ç”Ÿæˆè¯äº‘
         // æ ¹æ®æƒé‡è®¾ç½®æ ·å¼
     }

     function renderVisitorStats(visitors) {
         // ç”Ÿæˆç»Ÿè®¡å›¾è¡¨
         // åœ°åŸŸåˆ†å¸ƒå¯è§†åŒ–
     }
     ```

  5. **ç”¨æˆ·äº¤äº’æ¨¡å—**
     - æœç´¢åŠŸèƒ½
     - ç­›é€‰åŠŸèƒ½
     - åˆ†é¡µåŠŸèƒ½
     - ç¼–è¾‘/åˆ é™¤æ“ä½œ

  6. **è‡ªåŠ¨è¿½è¸ªæ¨¡å—**
     ```javascript
     // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è®°å½•è®¿é—®
     window.addEventListener('load', () => {
         trackVisit();
     });

     async function trackVisit() {
         // è·å–IPåœ°å€
         // è°ƒç”¨æ·˜å®IP APIè·å–åœ°åŸŸ
         // POST /api/visitors
     }
     ```

---

### 3. åç«¯æœåŠ¡å™¨å±‚

#### server-json.js (2022è¡Œ)
- **æ–‡ä»¶è·¯å¾„**: `/server-json.js`
- **åŠŸèƒ½**: Node.jsåç«¯æœåŠ¡å™¨
- **ä¸»è¦æ¨¡å—**:

  1. **ä¾èµ–æ¨¡å—**
     ```javascript
     const express = require('express');
     const fs = require('fs');
     const path = require('path');
     const jwt = require('jsonwebtoken');
     const bcrypt = require('bcryptjs');
     ```

  2. **é…ç½®ç®¡ç†**
     ```javascript
     const app = express();
     const PORT = process.env.PORT || 3000;
     const JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key';

     // æ•°æ®æ–‡ä»¶è·¯å¾„
     const DATA_DIR = path.join(__dirname, 'data');
     const NEWS_FILE = path.join(DATA_DIR, 'news.json');
     const WEEKLY_NEWS_FILE = path.join(DATA_DIR, 'weekly-news.json');
     const TOOLS_FILE = path.join(DATA_DIR, 'tools.json');
     const KEYWORDS_FILE = path.join(DATA_DIR, 'keywords.json');
     const VISITORS_FILE = path.join(DATA_DIR, 'visitors.json');
     const SETTINGS_FILE = path.join(DATA_DIR, 'settings.json');
     const ARCHIVE_DIR = path.join(DATA_DIR, 'archive');
     ```

  3. **ä¸­é—´ä»¶**
     ```javascript
     // CORSè®¾ç½®
     app.use((req, res, next) => {
         res.header('Access-Control-Allow-Origin', '*');
         res.header('Access-Control-Allow-Headers', '*');
         res.header('Access-Control-Allow-Methods', '*');
         next();
     });

     // JSONè§£æ
     app.use(express.json());

     // JWTè®¤è¯ä¸­é—´ä»¶
     function authenticateToken(req, res, next) {
         const authHeader = req.headers['authorization'];
         const token = authHeader && authHeader.split(' ')[1];

         if (!token) {
             return res.status(401).json({ error: 'éœ€è¦è®¤è¯' });
         }

         jwt.verify(token, JWT_SECRET, (err, user) => {
             if (err) return res.status(403).json({ error: 'æ— æ•ˆtoken' });
             req.user = user;
             next();
         });
     }
     ```

  4. **æ•°æ®æ“ä½œå‡½æ•°**
     ```javascript
     function readData(filePath) {
         // è¯»å–JSONæ–‡ä»¶
         // å¦‚æœä¸å­˜åœ¨åˆ™åˆå§‹åŒ–
     }

     function writeData(filePath, data) {
         // å†™å…¥JSONæ–‡ä»¶
         // åŸå­å†™å…¥ä¿è¯æ•°æ®å®‰å…¨
     }

     function generateId(prefix) {
         // ç”Ÿæˆå”¯ä¸€ID
         // æ”¯æŒæ—¥æœŸæ ¼å¼
     }
     ```

  5. **å½’æ¡£ç³»ç»Ÿ**
     ```javascript
     function archiveOldNews() {
         // å°†æ—§èµ„è®¯ç§»åˆ°archiveç›®å½•
         // æŒ‰æ—¥æœŸå½’æ¡£: archive/news-2026-02-04.json
         // è¿”å›å½’æ¡£ç»Ÿè®¡
     }

     function archiveOldWeeklyNews() {
         // å½’æ¡£æ—§æ¯å‘¨èµ„è®¯
         // æŒ‰å‘¨å½’æ¡£
     }
     ```

  6. **41ä¸ªAPIç«¯ç‚¹**

     **è®¤è¯ç›¸å…³** (1ä¸ª):
     - `POST /api/auth/login` - ç®¡ç†å‘˜ç™»å½•

     **ä»Šæ—¥èµ„è®¯** (4ä¸ª):
     - `GET /api/news` - è·å–èµ„è®¯åˆ—è¡¨ (æ”¯æŒcountå‚æ•°)
     - `POST /api/news` - åˆ›å»ºå•æ¡èµ„è®¯
     - `POST /api/news/batch` - æ‰¹é‡å¯¼å…¥èµ„è®¯ (è‡ªåŠ¨å½’æ¡£)
     - `DELETE /api/news/:id` - åˆ é™¤èµ„è®¯

     **æ¯å‘¨èµ„è®¯** (5ä¸ª):
     - `GET /api/weekly-news` - è·å–æ¯å‘¨èµ„è®¯ (æ”¯æŒåˆ†ç±»ç­›é€‰)
     - `POST /api/weekly-news` - åˆ›å»ºæ¯å‘¨èµ„è®¯
     - `PUT /api/weekly-news/:id` - æ›´æ–°æ¯å‘¨èµ„è®¯
     - `DELETE /api/weekly-news/:id` - åˆ é™¤æ¯å‘¨èµ„è®¯
     - `POST /api/weekly-news/batch` - æ‰¹é‡å¯¼å…¥ (è‡ªåŠ¨å½’æ¡£)

     **AIå·¥å…·** (5ä¸ª):
     - `GET /api/tools` - è·å–å·¥å…·åˆ—è¡¨ (æ”¯æŒç­›é€‰ã€åˆ†é¡µ)
     - `GET /api/tools/categories` - è·å–å·¥å…·åˆ†ç±»
     - `GET /api/tools/:id` - è·å–å•ä¸ªå·¥å…·
     - `POST /api/tools` - æ·»åŠ å·¥å…· (ç®¡ç†å‘˜)
     - `PUT /api/tools/:id` - æ›´æ–°å·¥å…· (ç®¡ç†å‘˜)
     - `DELETE /api/tools/:id` - åˆ é™¤å·¥å…· (ç®¡ç†å‘˜)
     - `POST /api/tools/batch` - æ‰¹é‡å¯¼å…¥ (ç®¡ç†å‘˜)
     - `POST /api/tools/upload-logo` - ä¸Šä¼ Logo (ç®¡ç†å‘˜)

     **å…³é”®è¯** (3ä¸ª):
     - `GET /api/keywords` - è·å–å…³é”®è¯åˆ—è¡¨
     - `POST /api/keywords/batch` - æ‰¹é‡å¯¼å…¥å…³é”®è¯
     - `DELETE /api/keywords/:id` - åˆ é™¤å…³é”®è¯

     **è®¿å®¢è¿½è¸ª** (2ä¸ª):
     - `GET /api/visitors` - è·å–è®¿å®¢è®°å½•
     - `POST /api/visitors` - è®°å½•æ–°è®¿é—®

     **ç»Ÿè®¡æ•°æ®** (1ä¸ª):
     - `GET /api/stats` - è·å–ç»Ÿè®¡æ•°æ®

     **ç³»ç»Ÿè®¾ç½®** (2ä¸ª):
     - `GET /api/settings` - è·å–ç³»ç»Ÿè®¾ç½®
     - `POST /api/settings` - æ›´æ–°ç³»ç»Ÿè®¾ç½®

     **å½’æ¡£ç³»ç»Ÿ** (3ä¸ª):
     - `GET /api/archive/dates` - è·å–å½’æ¡£æ—¥æœŸåˆ—è¡¨
     - `GET /api/archive/:date` - è·å–æŒ‡å®šæ—¥æœŸæ•°æ®
     - `DELETE /api/archive/:date` - åˆ é™¤æŒ‡å®šæ—¥æœŸå½’æ¡£

     **æ¨¡æ¿ä¸‹è½½** (2ä¸ª):
     - `GET /api/news/template` - ä¸‹è½½ä»Šæ—¥èµ„è®¯æ¨¡æ¿
     - `GET /api/weekly-news/template` - ä¸‹è½½æ¯å‘¨èµ„è®¯æ¨¡æ¿

  7. **å¯åŠ¨ä»£ç **
     ```javascript
     app.listen(PORT, () => {
         console.log(`ğŸš€ æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${PORT}`);
         console.log(`ğŸ“Š APIç«¯ç‚¹:`);
         // åˆ—å‡ºæ‰€æœ‰ç«¯ç‚¹
     });
     ```

---

### 4. æ•°æ®å­˜å‚¨å±‚

#### data/news.json - ä»Šæ—¥èµ„è®¯æ•°æ®
- **æ–‡ä»¶è·¯å¾„**: `/data/news.json`
- **æ•°æ®ç»“æ„**:
  ```json
  {
    "news": [
      {
        "id": "2026020512345",
        "title": "æ–‡ç« æ ‡é¢˜",
        "summary": "æ–‡ç« æ‘˜è¦",
        "key_point": "æ ¸å¿ƒè§‚ç‚¹",
        "source_url": "https://...",
        "source_name": "æ¥æºåç§°",
        "category": "æŠ€æœ¯",
        "sub_category": "å¤§è¯­è¨€æ¨¡å‹",
        "country": "global",
        "importance_score": 8,
        "is_today": true,
        "published_at": "2026-02-05T09:00:00.000Z",
        "created_at": "2026-02-05T10:30:00.000Z"
      }
    ],
    "lastUpdated": "2026-02-05T10:30:00.000Z",
    "totalCount": 15
  }
  ```
- **è¯»å†™æ“ä½œ**:
  - **è¯»å–**: æ‰€æœ‰é¡µé¢çš„ `GET /api/news` è°ƒç”¨
  - **å†™å…¥**:
    - `POST /api/news/batch` - æ‰¹é‡å¯¼å…¥æ—¶å®Œå…¨æ›¿æ¢
    - `DELETE /api/news/:id` - åˆ é™¤æ—¶ç§»é™¤å…ƒç´ 
  - **å½’æ¡£**: è°ƒç”¨ `archiveOldNews()` å°†æ—§æ•°æ®ç§»åˆ° `archive/` ç›®å½•

#### data/weekly-news.json - æ¯å‘¨èµ„è®¯æ•°æ®
- **æ–‡ä»¶è·¯å¾„**: `/data/weekly-news.json`
- **æ•°æ®ç»“æ„**:
  ```json
  {
    "weeklyNews": [
      {
        "id": "weekly_2026020512345",
        "title": "å‘¨åˆŠæ ‡é¢˜",
        "summary": "æ‘˜è¦",
        "key_point": "æ ¸å¿ƒè§‚ç‚¹",
        "weekly_category": "tech",
        "week_number": "2026-W06",
        "week_start_date": "2026-02-03",
        "is_weekly_featured": true,
        "published_at": "2026-02-05T09:00:00.000Z",
        "created_at": "2026-02-05T10:30:00.000Z"
      }
    ]
  }
  ```

#### data/tools.json - AIå·¥å…·æ•°æ®
- **æ–‡ä»¶è·¯å¾„**: `/data/tools.json`
- **æ•°æ®ç»“æ„**:
  ```json
  {
    "tools": [
      {
        "id": "tool_1234567890",
        "name": "ChatGPT",
        "description": "OpenAIçš„å¯¹è¯AI",
        "url": "https://chat.openai.com",
        "logo": "logos/chatgpt.png",
        "category": "å¤§è¯­è¨€æ¨¡å‹",
        "pricing": "freemium",
        "features": ["å¯¹è¯", "ä»£ç ç”Ÿæˆ"],
        "created_at": "2026-02-05T10:30:00.000Z"
      }
    ]
  }
  ```

#### data/keywords.json - å…³é”®è¯æ•°æ®
- **æ–‡ä»¶è·¯å¾„**: `/data/keywords.json`
- **æ•°æ®ç»“æ„**:
  ```json
  {
    "keywords": [
      {
        "id": 1707123456789,
        "text": "äººå·¥æ™ºèƒ½",
        "weight": 5,
        "size": "large",
        "created_at": "2026-02-05T10:30:00.000Z"
      }
    ]
  }
  ```

#### data/visitors.json - è®¿å®¢è®°å½•æ•°æ®
- **æ–‡ä»¶è·¯å¾„**: `/data/visitors.json`
- **æ•°æ®ç»“æ„**:
  ```json
  {
    "visitors": [
      {
        "id": 1707123456789,
        "ip": "123.45.67.89",
        "province": "å¹¿ä¸œçœ",
        "country": "ä¸­å›½",
        "date": "2026-02-05T10:30:00.000Z"
      }
    ]
  }
  ```

#### data/settings.json - ç³»ç»Ÿè®¾ç½®
- **æ–‡ä»¶è·¯å¾„**: `/data/settings.json`
- **æ•°æ®ç»“æ„**:
  ```json
  {
    "siteName": "AIèµ„è®¯ç½‘",
    "dailyNewsCount": 15,
    "weeklyNewsCount": 5,
    "toolsCount": 20,
    "keywordsCount": 30,
    "enableTracking": true,
    "lastUpdated": "2026-02-05T10:30:00.000Z"
  }
  ```

#### data/archive/ - å†å²å½’æ¡£ç›®å½•
- **ç›®å½•è·¯å¾„**: `/data/archive/`
- **æ–‡ä»¶å‘½å**: `news-2026-02-04.json`, `weekly-2026-W05.json`
- **æ•°æ®ç»“æ„**: ä¸ä¸»æ–‡ä»¶ç›¸åŒ
- **APIè®¿é—®**: `GET /api/archive/:date`

---

### 5. è‡ªåŠ¨åŒ–è„šæœ¬å±‚

#### scripts/html-to-json-converter.js - HTMLè½¬JSONè½¬æ¢å™¨
- **æ–‡ä»¶è·¯å¾„**: `/scripts/html-to-json-converter.js`
- **åŠŸèƒ½**: å°†æ—¥æŠ¥HTMLæ–‡ä»¶è½¬æ¢ä¸ºJSONæ ¼å¼
- **è¾“å…¥**:
  - HTMLæ–‡ä»¶è·¯å¾„ (å‘½ä»¤è¡Œå‚æ•°)
  - HTMLæ ¼å¼: `<div class="article">` æˆ– `<section style="margin-bottom: 30px">`
- **è¾“å‡º**:
  - JSONæ–‡ä»¶ä¿å­˜åˆ° `/data/news-YYYY-MM-DD.json`
  - åŒ…å«æ–‡ç« æ•°ç»„: title, summary, key_point, source_url, categoryç­‰

**ä¸»è¦å‡½æ•°**:
```javascript
// ä¸»è½¬æ¢å‡½æ•°
function convertHtmlToJson(htmlFilePath) {
    const html = fs.readFileSync(htmlFilePath, 'utf-8');

    // æå–æ—¥æœŸ
    const titleMatch = html.match(/<h1[^>]*>.*?(\d{4}-\d{2}-\d{2}).*?<\/h1>/);

    // æå–æ‰€æœ‰æ–‡ç« section (æ”¯æŒä¸¤ç§æ ¼å¼)
    const articleRegex = /<(div|section)[^>]*(?:class="article"|style="[^"]*margin-bottom:\s*30px[^"]*")[^>]*>(.*?)<\/\1>/gs;
    const sections = html.match(articleRegex) || [];

    const articles = [];
    sections.forEach((section, index) => {
        // è·³è¿‡å¯¼è¯»section
        if (section.includes('æœ¬æœŸå¯¼è¯»')) return;

        // æå–æ ‡é¢˜ã€æ‘˜è¦ã€æ ¸å¿ƒè§‚ç‚¹ã€æ¥æºç­‰
        const titleMatch = section.match(/<h3[^>]*>(.*?)<\/h3>/);
        const summaryMatch = section.match(/ã€æƒ…æŠ¥é€Ÿé€’ã€‘.*?<\/p>/s);
        const keyPointMatch = section.match(/ã€æ·±åº¦ç ”åˆ¤ã€‘.*?(?=<section|<\/section>)/s);
        const sourceMatch = section.match(/ğŸ”—\s*æ¥æº:\s*([^<\n]+)/);
        const urlMatch = section.match(/ğŸ”—\s*åŸæ–‡é“¾æ¥:\s*<a[^>]*href="([^"]*)"/);

        // ç”Ÿæˆæ–‡ç« å¯¹è±¡
        const article = {
            title: titleMatch ? titleMatch[1].trim() : `æ–‡ç« ${index + 1}`,
            key_point: keyPointMatch ? keyPointMatch[0].replace(/<[^>]*>/g, '').trim() : '',
            summary: summaryMatch ? summaryMatch[0].replace(/<[^>]*>/g, '').trim() : '',
            source_url: urlMatch ? urlMatch[1] : '#',
            source_name: sourceMatch ? sourceMatch[1].trim() : 'AIæ—¥æŠ¥',
            category: guessCategory(title, summary),
            sub_category: guessSubCategory(title, summary),
            country: 'global',
            importance_score: guessImportance(title, summary),
            published_at: new Date(dateStr + 'T09:00:00Z').toISOString()
        };

        articles.push(article);
    });

    return articles;
}

// ä¿å­˜åˆ°JSONæ–‡ä»¶
function saveToJson(articles, outputPath) {
    const json = JSON.stringify(articles, null, 2);
    fs.writeFileSync(outputPath, json, 'utf-8');
}

// å‘½ä»¤è¡Œè°ƒç”¨
// node scripts/html-to-json-converter.js /path/to/report.html
```

**è°ƒç”¨å…³ç³»**:
- è¢« `sync-reports-to-website.sh` è°ƒç”¨
- è¯»å–: `/var/www/html/reports/AI_Daily_YYYY-MM-DD.html`
- ç”Ÿæˆ: `/var/www/ai-coming-website/data/news-YYYY-MM-DD.json`

---

#### sync-reports-to-website.sh - æ—¥æŠ¥åŒæ­¥è„šæœ¬
- **æ–‡ä»¶è·¯å¾„**: `/sync-reports-to-website.sh`
- **åŠŸèƒ½**: è‡ªåŠ¨åŒæ­¥æœ€æ–°æ—¥æŠ¥åˆ°ç½‘ç«™
- **è¿è¡Œé¢‘ç‡**: æ¯å¤© 09:05 (é€šè¿‡cron)

**å·¥ä½œæµç¨‹**:
```bash
#!/bin/bash

# 1. é…ç½®å˜é‡
REPORT_SOURCE_DIR="/var/www/html/reports"
PROJECT_DIR="/var/www/ai-coming-website"
API_URL="http://localhost:3000/api/news/batch"
ADMIN_USERNAME="admin"
ADMIN_PASSWORD="admin123456"

# 2. æŸ¥æ‰¾æœ€æ–°çš„HTMLæ–‡ä»¶
LATEST_HTML=$(find "$REPORT_SOURCE_DIR" -name "*.html" -type f -printf '%T@ %p\n' | sort -rn | head -1 | cut -d' ' -f2-)

# 3. è°ƒç”¨è½¬æ¢å™¨
node scripts/html-to-json-converter.js "$LATEST_HTML"
# ç”Ÿæˆ: data/news-YYYY-MM-DD.json

# 4. è·å–ç®¡ç†å‘˜Token
token=$(curl -s -X POST http://localhost:3000/api/auth/login \
    -H "Content-Type: application/json" \
    -d "{\"username\":\"$ADMIN_USERNAME\",\"password\":\"$ADMIN_PASSWORD\"}" \
    | grep -o '"token":"[^"]*"' | cut -d'"' -f4)

# 5. åŒ…è£…JSONä¸ºAPIæœŸæœ›æ ¼å¼
node -e "const fs = require('fs'); const data = JSON.parse(fs.readFileSync('$json_file', 'utf-8')); fs.writeFileSync('$wrapped_json', JSON.stringify({articles: data}, null,2));"

# 6. å¯¼å…¥åˆ°ç½‘ç«™
curl -s -X POST "$API_URL" \
    -H "Content-Type: application/json" \
    -H "Authorization: Bearer $token" \
    -d @"$wrapped_json"

# 7. å½’æ¡£å·²å¤„ç†çš„HTMLæ–‡ä»¶
mv "$LATEST_HTML" "$PROJECT_DIR/reports-archive/"
```

**æ–‡ä»¶äº¤äº’**:
- **è¯»å–**: `/var/www/html/reports/AI_Daily_*.html` (æœ€æ–°çš„ä¸€ä¸ª)
- **è°ƒç”¨**: `scripts/html-to-json-converter.js`
- **è¯»å–ç”Ÿæˆçš„JSON**: `data/news-*.json`
- **APIè°ƒç”¨**: `POST /api/news/batch`
- **å†™å…¥å½’æ¡£**: `reports-archive/AI_Daily_*.html`
- **æ—¥å¿—å†™å…¥**: `logs/report-sync.log`

---

#### setup-report-sync.sh - åŒæ­¥è®¾ç½®è„šæœ¬
- **æ–‡ä»¶è·¯å¾„**: `/setup-report-sync.sh`
- **åŠŸèƒ½**: ä¸€é”®è®¾ç½®æ—¥æŠ¥åŒæ­¥æœåŠ¡
- **è¿è¡Œæ—¶æœº**: é¦–æ¬¡éƒ¨ç½²æˆ–é‡æ–°é…ç½®æ—¶

**å·¥ä½œæµç¨‹**:
```bash
#!/bin/bash

# 1. è®¾ç½®è„šæœ¬æƒé™
chmod +x sync-reports-to-website.sh

# 2. åˆ›å»ºå¿…è¦ç›®å½•
mkdir -p "$REPORT_SOURCE_DIR"
mkdir -p "$PROJECT_DIR/reports-archive"
mkdir -p "$PROJECT_DIR/logs"

# 3. æµ‹è¯•è¿è¡Œä¸€æ¬¡ï¼ˆå¯é€‰ï¼‰
# æ£€æµ‹æºç›®å½•æ–‡ä»¶æ•°é‡
# è¯¢é—®ç”¨æˆ·æ˜¯å¦ç«‹å³åŒæ­¥

# 4. è®¾ç½®cronå®šæ—¶ä»»åŠ¡
# åˆ é™¤æ—§ä»»åŠ¡
(crontab -l 2>/dev/null | grep -v "sync-reports-to-website") | crontab -

# æ·»åŠ æ–°ä»»åŠ¡: æ¯å¤©9:05
(crontab -l 2>/dev/null; echo "5 9 * * * $SYNC_SCRIPT >> $PROJECT_DIR/logs/cron.log 2>&1") | crontab -
```

**æ–‡ä»¶äº¤äº’**:
- **ä¿®æ”¹**: crontab (æ·»åŠ å®šæ—¶ä»»åŠ¡)
- **åˆ›å»ºç›®å½•**: reports-archive/, logs/
- **è°ƒç”¨**: sync-reports-to-website.sh (æµ‹è¯•è¿è¡Œ)

---

### 6. é…ç½®æ–‡ä»¶

#### .env - ç¯å¢ƒå˜é‡é…ç½®
- **æ–‡ä»¶è·¯å¾„**: `/.env`
- **åŠŸèƒ½**: å­˜å‚¨æ•æ„Ÿé…ç½®ä¿¡æ¯
- **å†…å®¹ç¤ºä¾‹**:
  ```bash
  PORT=3000
  JWT_SECRET=your-secret-key-change-in-production
  ADMIN_USERNAME=admin
  ADMIN_PASSWORD=admin123456

  # Qwen APIé…ç½®
  QWEN_API_KEY=your-qwen-api-key
  QWEN_API_URL=https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation

  # æ•°æ®åº“é…ç½® (å¦‚æœä½¿ç”¨MySQLæ¨¡å¼)
  # DB_HOST=localhost
  # DB_PORT=3306
  # DB_NAME=ai_news
  # DB_USER=root
  # DB_PASSWORD=password
  ```
- **ä½¿ç”¨**:
  - `server-json.js` é€šè¿‡ `process.env` è¯»å–
  - ä¸æäº¤åˆ°Git (åœ¨.gitignoreä¸­)

#### package.json - é¡¹ç›®ä¾èµ–é…ç½®
- **æ–‡ä»¶è·¯å¾„**: `/package.json`
- **åŠŸèƒ½**: å®šä¹‰é¡¹ç›®å…ƒä¿¡æ¯å’Œä¾èµ–
- **ä¸»è¦å†…å®¹**:
  ```json
  {
    "name": "ai-coming-website",
    "version": "1.0.0",
    "description": "AIèµ„è®¯ç½‘ç«™",
    "main": "server-json.js",
    "scripts": {
      "start": "node server-json.js",
      "start:legacy": "node server.js",
      "dev": "nodemon server-json.js"
    },
    "dependencies": {
      "express": "^4.18.2",
      "jsonwebtoken": "^9.0.0",
      "bcryptjs": "^2.4.3",
      "cors": "^2.8.5"
    }
  }
  ```
- **ä½¿ç”¨**:
  - `npm install` - å®‰è£…ä¾èµ–
  - `npm start` - å¯åŠ¨æœåŠ¡å™¨

---

## å®Œæ•´æ•°æ®æµå‘å›¾

### ç”¨æˆ·è®¿é—®æµç¨‹
```
ç”¨æˆ·æµè§ˆå™¨
    â†“
[HTMLé¡µé¢] (index.html / news.html / etc.)
    â†“ åŠ è½½ <script src="js/main.js">
[js/main.js]
    â†“ window.addEventListener('DOMContentLoaded')
é¡µé¢åˆå§‹åŒ–
    â†“ è°ƒç”¨ API
[HTTPè¯·æ±‚] â†’ GET /api/news
    â†“
[server-json.js] - ExpressæœåŠ¡å™¨
    â†“ readData(NEWS_FILE)
[data/news.json] - è¯»å–JSONæ–‡ä»¶
    â†“ è¿”å› JSON
[HTTPå“åº”] â† JSONæ•°æ®
    â†“
[js/main.js] - renderNewsCards(newsData)
    â†“ ç”ŸæˆHTML
[DOMæ›´æ–°] - æ’å…¥åˆ°é¡µé¢
    â†“
ç”¨æˆ·çœ‹åˆ°å†…å®¹
```

### ç®¡ç†å‘˜æ“ä½œæµç¨‹ (æ‰¹é‡å¯¼å…¥èµ„è®¯)
```
ç®¡ç†å‘˜
    â†“ æ‰“å¼€ admin.html
[ç™»å½•ç•Œé¢]
    â†“ è¾“å…¥ç”¨æˆ·åå¯†ç 
[POST /api/auth/login]
    â†“ {username, password}
[server-json.js]
    â†“ éªŒè¯ç”¨æˆ·åå¯†ç 
    â†“ ç”ŸæˆJWT token
[å“åº”] â† {token: "eyJhbGciOiJIUzI1NiIs..."}
    â†“ ä¿å­˜åˆ° localStorage
localStorage.setItem('adminToken', token)
    â†“
[ç®¡ç†ç•Œé¢] - å¯¼å…¥åŠŸèƒ½
    â†“ é€‰æ‹©JSONæ–‡ä»¶
[js/main.js] - æå–æ–‡ä»¶å†…å®¹
    â†“ POST /api/news/batch
    â†“ Headers: Authorization: Bearer {token}
    â†“ Body: {articles: [...]}
[server-json.js]
    â†“ authenticateToken ä¸­é—´ä»¶
    â†“ éªŒè¯JWT token
    â†“ archiveOldNews() - å½’æ¡£æ—§æ•°æ®
    â†“ writeData(NEWS_FILE, newData) - å†™å…¥æ–°æ•°æ®
[data/archive/news-2026-02-04.json] - æ—§æ•°æ®å½’æ¡£
[data/news.json] - æ–°æ•°æ®æ›¿æ¢
    â†“ å“åº”æˆåŠŸ
[å“åº”] â† {message: "æˆåŠŸå¯¼å…¥ 15 ç¯‡æ–°é—»"}
    â†“
[js/main.js] - æ˜¾ç¤ºæˆåŠŸæç¤º
    â†“ åˆ·æ–°æ•°æ®
[GET /api/news]
    â†“
æ›´æ–°é¡µé¢æ˜¾ç¤º
```

### æ—¥æŠ¥è‡ªåŠ¨åŒæ­¥æµç¨‹ (å®šæ—¶ä»»åŠ¡)
```
ç³»ç»Ÿå®šæ—¶ä»»åŠ¡ (Cron)
    â†“ æ¯å¤© 09:05
[cron - 5 9 * * *]
    â†“ æ‰§è¡Œè„šæœ¬
[sync-reports-to-website.sh]
    â†“ 1. æŸ¥æ‰¾æœ€æ–°HTML
find /var/www/html/reports -name "*.html" -type f | sort -rn | head -1
    â†“ æ‰¾åˆ°: AI_Daily_2026-02-05.html
    â†“ 2. è°ƒç”¨è½¬æ¢å™¨
node scripts/html-to-json-converter.js AI_Daily_2026-02-05.html
    â†“ è¯»å–HTML
[AI_Daily_2026-02-05.html]
    â†“ è§£æ <div class="article"> æå–å†…å®¹
    â†“ ç”ŸæˆJSONæ•°ç»„
[ç”Ÿæˆ: data/news-2026-02-05.json]
    â†“ 3. è·å–Token
curl -X POST http://localhost:3000/api/auth/login
    â†“ è¿”å› token
    â†“ 4. åŒ…è£…JSONæ•°æ®
node -e "JSON.stringify({articles: data})"
    â†“ 5. å¯¼å…¥åˆ°ç½‘ç«™
curl -X POST http://localhost:3000/api/news/batch \
    -H "Authorization: Bearer {token}" \
    -d @wrapped-import.json
    â†“
[server-json.js]
    â†“ authenticateToken éªŒè¯
    â†“ archiveOldNews() å½’æ¡£æ—§èµ„è®¯
    â†“ writeData(NEWS_FILE, newArticles) å†™å…¥æ–°èµ„è®¯
[data/news.json] - æ›´æ–°ä»Šæ—¥èµ„è®¯
[data/archive/news-2026-02-04.json] - å½’æ¡£æ—§èµ„è®¯
    â†“ 6. å½’æ¡£HTMLæ–‡ä»¶
mv AI_Daily_2026-02-05.html reports-archive/
    â†“ 7. è®°å½•æ—¥å¿—
echo "[2026-02-05 09:05:01] âœ¨ åŒæ­¥å®Œæˆï¼" >> logs/report-sync.log
    â†“
å®Œæˆ - ç”¨æˆ·è®¿é—® news.html å¯çœ‹åˆ°æ–°èµ„è®¯
```

### è®¿å®¢è¿½è¸ªæµç¨‹ (è‡ªåŠ¨åŒ–)
```
ä»»ä½•ç”¨æˆ·è®¿é—®ä»»ä½•HTMLé¡µé¢
    â†“
[HTMLé¡µé¢] - <script src="js/main.js"></script>
    â†“
js/main.js - window.addEventListener('load', trackVisit)
    â†“
[trackVisit å‡½æ•°]
    â†“ 1. è·å–IPåœ°å€
fetch('https://api.ipify.org?format=json')
    â†“ è¿”å›: {ip: "123.45.67.89"}
    â†“ 2. è°ƒç”¨æ·˜å®IP API
fetch(`http://ip.taobao.com/outGetIpInfo?ip=${ip}&accessKey=alibaba-inc`)
    â†“ è¿”å›: {data: {region: 'å¹¿ä¸œ'}}
    â†“ 3. å‘é€åˆ°æœåŠ¡å™¨
POST /api/visitors
Body: {ip: "123.45.67.89", province: "å¹¿ä¸œçœ", country: "ä¸­å›½"}
    â†“
[server-json.js]
    â†“ readData(VISITORS_FILE)
    â†“ æ·»åŠ æ–°è®¿é—®è®°å½•
    â†“ writeData(VISITORS_FILE, updatedData)
[data/visitors.json] - æ–°å¢è®°å½•
    â†“
[å“åº”] â† {success: true}
    â†“
ç®¡ç†å‘˜è®¿é—® visitors.html æŸ¥çœ‹ç»Ÿè®¡
    â†“ GET /api/visitors
[server-json.js] - readData(VISITORS_FILE)
    â†“ è¿”å›æ‰€æœ‰è®¿å®¢è®°å½•
[visitors.html] - æ¸²æŸ“åœ°åŸŸåˆ†å¸ƒå›¾
```

---

## å…³é”®APIç«¯ç‚¹ä¸æ–‡ä»¶æ˜ å°„è¡¨

| APIç«¯ç‚¹ | HTTPæ–¹æ³• | è¯»å–æ–‡ä»¶ | å†™å…¥æ–‡ä»¶ | åŠŸèƒ½æè¿° |
|---------|---------|---------|---------|---------|
| `/api/auth/login` | POST | - | - | éªŒè¯ç”¨æˆ·ï¼Œè¿”å›JWT token |
| `/api/news` | GET | news.json | - | è·å–ä»Šæ—¥èµ„è®¯åˆ—è¡¨ |
| `/api/news/batch` | POST | news.json | news.json, archive/*.json | æ‰¹é‡å¯¼å…¥èµ„è®¯(è‡ªåŠ¨å½’æ¡£) |
| `/api/news/:id` | DELETE | news.json | news.json | åˆ é™¤å•æ¡èµ„è®¯ |
| `/api/weekly-news` | GET | weekly-news.json | - | è·å–æ¯å‘¨èµ„è®¯ |
| `/api/weekly-news` | POST | - | weekly-news.json | åˆ›å»ºæ¯å‘¨èµ„è®¯ |
| `/api/weekly-news/:id` | PUT | weekly-news.json | weekly-news.json | æ›´æ–°æ¯å‘¨èµ„è®¯ |
| `/api/weekly-news/:id` | DELETE | weekly-news.json | weekly-news.json | åˆ é™¤æ¯å‘¨èµ„è®¯ |
| `/api/weekly-news/batch` | POST | weekly-news.json | weekly-news.json, archive/*.json | æ‰¹é‡å¯¼å…¥(è‡ªåŠ¨å½’æ¡£) |
| `/api/tools` | GET | tools.json | - | è·å–AIå·¥å…·åˆ—è¡¨ |
| `/api/tools` | POST | - | tools.json | æ·»åŠ å·¥å…·(éœ€è®¤è¯) |
| `/api/tools/:id` | PUT | tools.json | tools.json | æ›´æ–°å·¥å…·(éœ€è®¤è¯) |
| `/api/tools/:id` | DELETE | tools.json | tools.json | åˆ é™¤å·¥å…·(éœ€è®¤è¯) |
| `/api/tools/batch` | POST | - | tools.json | æ‰¹é‡å¯¼å…¥å·¥å…·(éœ€è®¤è¯) |
| `/api/keywords` | GET | keywords.json | - | è·å–å…³é”®è¯åˆ—è¡¨ |
| `/api/keywords/batch` | POST | - | keywords.json | æ‰¹é‡å¯¼å…¥å…³é”®è¯(éœ€è®¤è¯) |
| `/api/keywords/:id` | DELETE | keywords.json | keywords.json | åˆ é™¤å…³é”®è¯(éœ€è®¤è¯) |
| `/api/visitors` | GET | visitors.json | - | è·å–è®¿å®¢è®°å½• |
| `/api/visitors` | POST | visitors.json | visitors.json | è®°å½•æ–°è®¿é—® |
| `/api/stats` | GET | news.json, visitors.json | - | è·å–ç»Ÿè®¡æ•°æ® |
| `/api/settings` | GET | settings.json | - | è·å–ç³»ç»Ÿè®¾ç½® |
| `/api/settings` | POST | settings.json | settings.json | æ›´æ–°ç³»ç»Ÿè®¾ç½®(éœ€è®¤è¯) |
| `/api/archive/dates` | GET | archive/ ç›®å½• | - | è·å–å½’æ¡£æ—¥æœŸåˆ—è¡¨ |
| `/api/archive/:date` | GET | archive/news-:date.json | - | è·å–æŒ‡å®šæ—¥æœŸæ•°æ® |
| `/api/archive/:date` | DELETE | archive/news-:date.json | - | åˆ é™¤æŒ‡å®šæ—¥æœŸå½’æ¡£(éœ€è®¤è¯) |

---

## å¯åŠ¨é¡ºåºä¸ä¾èµ–å…³ç³»

### é¦–æ¬¡éƒ¨ç½²å¯åŠ¨é¡ºåº

1. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```
   - è¯»å–: `package.json`
   - ç”Ÿæˆ: `node_modules/` ç›®å½•

2. **é…ç½®ç¯å¢ƒå˜é‡**
   ```bash
   cp .env.example .env
   # ç¼–è¾‘ .env æ–‡ä»¶
   ```
   - åˆ›å»º: `.env`

3. **åˆå§‹åŒ–æ•°æ®æ–‡ä»¶** (è‡ªåŠ¨)
   ```bash
   node server-json.js
   ```
   - `initDataFiles()` å‡½æ•°è‡ªåŠ¨åˆ›å»º:
     - `data/news.json`
     - `data/weekly-news.json`
     - `data/tools.json`
     - `data/keywords.json`
     - `data/visitors.json`
     - `data/settings.json`
     - `data/archive/` ç›®å½•

4. **å¯åŠ¨æœåŠ¡å™¨**
   ```bash
   npm start
   # æˆ–
   pm2 start server-json.js --name ai-news-system
   ```
   - è¯»å–: `.env`, `data/*.json`
   - å¯åŠ¨: HTTPæœåŠ¡å™¨åœ¨ç«¯å£3000

5. **é…ç½®æ—¥æŠ¥åŒæ­¥** (å¯é€‰)
   ```bash
   ./setup-report-sync.sh
   ```
   - è®¾ç½®: cronå®šæ—¶ä»»åŠ¡
   - åˆ›å»º: `reports-archive/`, `logs/` ç›®å½•

### æ­£å¸¸è¿è¡Œæ—¶çš„æ–‡ä»¶è¯»å–é¡ºåº

```
æœåŠ¡å™¨å¯åŠ¨
    â†“
è¯»å– .env
    â†“
è¯»å–æ‰€æœ‰ data/*.json
    â†“
å¯åŠ¨HTTPæœåŠ¡
    â†“
ç­‰å¾…è¯·æ±‚

ç”¨æˆ·è¯·æ±‚åˆ°è¾¾
    â†“
server-json.js è·¯ç”±åˆ†å‘
    â†“
è¯»å–å¯¹åº”JSONæ–‡ä»¶
    â†“
å¤„ç†è¯·æ±‚
    â†“ (å¦‚æœæ˜¯å†™æ“ä½œ)
å†™å…¥JSONæ–‡ä»¶
    â†“
è¿”å›å“åº”
```

---

## æ•…éšœæ’æŸ¥æŒ‡å—

### é—®é¢˜1: å‰ç«¯é¡µé¢æ— æ³•åŠ è½½æ•°æ®

**æ£€æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
2. æ£€æŸ¥ `js/main.js` æ˜¯å¦æ­£ç¡®åŠ è½½
3. æ£€æŸ¥APIè¯·æ±‚æ˜¯å¦æˆåŠŸ (Networkæ ‡ç­¾)
4. æ£€æŸ¥ `server-json.js` æ˜¯å¦æ­£åœ¨è¿è¡Œ
5. æ£€æŸ¥ `data/*.json` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®

**ç›¸å…³æ–‡ä»¶**:
- HTMLé¡µé¢: `index.html`, `news.html` ç­‰
- å‰ç«¯é€»è¾‘: `js/main.js`
- åç«¯æœåŠ¡: `server-json.js`
- æ•°æ®æ–‡ä»¶: `data/news.json` ç­‰

### é—®é¢˜2: ç®¡ç†å‘˜ç™»å½•å¤±è´¥

**æ£€æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥ `.env` ä¸­çš„ç”¨æˆ·åå¯†ç 
2. æ£€æŸ¥ `server-json.js` çš„è®¤è¯é€»è¾‘
3. æ£€æŸ¥JWT_SECRETé…ç½®
4. æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ

**ç›¸å…³æ–‡ä»¶**:
- ç¯å¢ƒé…ç½®: `.env`
- è®¤è¯é€»è¾‘: `server-json.js` (authenticateTokenå‡½æ•°)
- å‰ç«¯ç™»å½•: `js/main.js` (loginå‡½æ•°)

### é—®é¢˜3: æ—¥æŠ¥åŒæ­¥å¤±è´¥

**æ£€æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥ `/var/www/html/reports/` ç›®å½•æ˜¯å¦æœ‰HTMLæ–‡ä»¶
2. æ‰‹åŠ¨è¿è¡Œ `./sync-reports-to-website.sh` æŸ¥çœ‹é”™è¯¯
3. æ£€æŸ¥ `scripts/html-to-json-converter.js` çš„æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦åŒ¹é…HTMLç»“æ„
4. æ£€æŸ¥APIæ˜¯å¦å¯è®¿é—®
5. æŸ¥çœ‹æ—¥å¿— `logs/report-sync.log`

**ç›¸å…³æ–‡ä»¶**:
- åŒæ­¥è„šæœ¬: `sync-reports-to-website.sh`
- è½¬æ¢å™¨: `scripts/html-to-json-converter.js`
- è®¾ç½®è„šæœ¬: `setup-report-sync.sh`
- æ—¥å¿—æ–‡ä»¶: `logs/report-sync.log`
- æºHTML: `/var/www/html/reports/AI_Daily_*.html`
- ç›®æ ‡JSON: `data/news-*.json`

### é—®é¢˜4: ä¿®æ”¹æ•°æ®åé¡µé¢ä¸æ›´æ–°

**æ£€æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æ˜¯å¦æˆåŠŸå†™å…¥ `data/*.json` æ–‡ä»¶
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
3. æ£€æŸ¥å‰ç«¯æ˜¯å¦é‡æ–°è°ƒç”¨API
4. æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦éœ€è¦é‡å¯ (PM2: `pm2 restart ai-news-system`)

**ç›¸å…³æ–‡ä»¶**:
- æ•°æ®æ–‡ä»¶: `data/news.json` ç­‰
- å‰ç«¯é€»è¾‘: `js/main.js`
- æœåŠ¡å™¨: `server-json.js`

---

## æ€»ç»“

### æ ¸å¿ƒæ–‡ä»¶

1. **å‰ç«¯æ ¸å¿ƒ**: `js/main.js` (1500è¡Œ) - æ‰€æœ‰é¡µé¢çš„é€»è¾‘æ§åˆ¶å™¨
2. **åç«¯æ ¸å¿ƒ**: `server-json.js` (2022è¡Œ) - APIæœåŠ¡å™¨
3. **æ•°æ®å­˜å‚¨**: `data/*.json` (7ä¸ªJSONæ–‡ä»¶)
4. **è‡ªåŠ¨åŒ–**: `sync-reports-to-website.sh` + `html-to-json-converter.js`

### äº¤äº’å…³ç³»

```
ç”¨æˆ· â†’ HTML â†’ main.js â†’ API â†’ server-json.js â†’ JSONæ–‡ä»¶
                     â†‘                        â†“
                     â””â”€â”€â”€â”€â”€â”€â”€ æ•°æ®è¿”å› â†â”€â”€â”€â”€â”€â”€â”€â”˜

å¤–éƒ¨HTML â†’ syncè„šæœ¬ â†’ è½¬æ¢å™¨ â†’ JSON â†’ API â†’ server-json.js â†’ æ•°æ®åº“
  â†‘                                              â†“
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Cronå®šæ—¶ä»»åŠ¡ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµå‘

1. **è¯»å–æ•°æ®**: JSONæ–‡ä»¶ â†’ server-json.js â†’ API â†’ main.js â†’ é¡µé¢æ¸²æŸ“
2. **å†™å…¥æ•°æ®**: ç®¡ç†å‘˜æ“ä½œ â†’ main.js â†’ API â†’ server-json.js â†’ JSONæ–‡ä»¶
3. **è‡ªåŠ¨åŒæ­¥**: å¤–éƒ¨HTML â†’ è½¬æ¢å™¨ â†’ JSON â†’ API â†’ server-json.js â†’ JSONæ–‡ä»¶
